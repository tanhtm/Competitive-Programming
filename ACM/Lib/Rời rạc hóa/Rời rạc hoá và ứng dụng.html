<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-type" content="text/html; charset=UTF-8">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/gollum.css" media="all">
  <link rel="stylesheet" type="text/css" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/editor.css" media="all">
  <link rel="stylesheet" type="text/css" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/dialog.css" media="all">
  <link rel="stylesheet" type="text/css" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/template.css" media="all">
  <link rel="stylesheet" type="text/css" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/print.css" media="print">
  
  

  <!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="/wiki/css/ie7.css" media="all">
  <![endif]-->

  <script src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/osd.js"></script><script src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/ca-pub-7999681867463377.js"></script><script id="facebook-jssdk" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/sdk.js"></script><script async="" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/analytics.js"></script><script>
      var baseUrl = '/wiki';
      var uploadDest   = '';
      var pageFullPath = 'algo/trick/Roi rac hoa va ung dung';
  </script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/jquery-1.js"></script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/mousetrap.js"></script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/gollum_004.js"></script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/gollum.js"></script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/gollum_003.js"></script>
  <script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/gollum_002.js"></script>
  <script type="text/javascript">
  window.MathJax = {
    tex2jax: {
      inlineMath:  [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
      processEscapes: true
    },
    TeX: { extensions: ["autoload-all.js"] }
  };
  </script>
  <script>(function(d,j){
  j = d.createElement('script');
  j.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  (d.head || d.getElementsByTagName('head')[0]).appendChild(j);
  }(document));
  </script><script src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/MathJax.js"></script>
  

  <title>Rời rạc hoá và ứng dụng</title>
  <!-- Google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-61806804-1', 'auto');
    ga('send', 'pageview');

  </script>

  <script async="" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7999681867463377",
      enable_page_level_ads: true
  });
  </script>
<link rel="preload" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/integrator_002.js" as="script"><script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/integrator_002.js"></script><link rel="preload" href="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/integrator.js" as="script"><script type="text/javascript" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/integrator.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:-webkit-sticky;top:0}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in_v1{animation-duration:250ms;animation-name:fb_bounce_in_v1}.fb_customer_chat_bounce_out_v1{animation-duration:250ms;animation-name:fb_bounce_out_v1}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_in_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_out_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bubble_pop_in{animation-duration:250ms;animation-name:fb_customer_chat_bubble_bounce_in_animation}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_bounce_in_v1{0%{opacity:0;transform:scale(.8, .8);transform-origin:bottom right}80%{opacity:.8;transform:scale(1.03, 1.03)}100%{opacity:1;transform:scale(1, 1)}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_v2_mobile_chat_started{0%{opacity:0;top:20px}100%{opacity:1;top:0}}@keyframes fb_bounce_out_v1{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="ff"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
    <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="http://staticxx.facebook.com/connect/xd_arbiter/r/1e2RywyANNe.js?version=42#channel=f57af90bccd8c&amp;origin=http%3A%2F%2Fvnoi.info" frameborder="0"></iframe><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/1e2RywyANNe_002.html" frameborder="0"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="f8fedd855c756" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" style="display: none;" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/ping.html" frameborder="0"></iframe></div></div></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.7&appId=449532395210446";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
<script>
Mousetrap.bind(['e'], function( e ) {
  e.preventDefault();
  window.location = "/edit" + window.location.pathname;
  return false;
});
</script>
<div id="wiki-wrapper" class="page">
<div id="head">
  <h1>Rời rạc hoá và ứng dụng</h1>
  <ul class="actions">
    <li class="minibutton">
      <div id="searchbar">
        <form action="/wiki/search" method="get" id="search-form">
        <div id="searchbar-fauxtext">
          <input name="q" id="search-query" value="Search…" autocomplete="off" class="ph" type="text">
          <a href="#" id="search-submit" title="Search this wiki">
            <span>Search</span>
          </a>
        </div>
        </form>
      </div>    </li>
    <li class="minibutton"><a href="http://vnoi.info/wiki/" class="action-home-page">Home</a></li>
    <li class="minibutton"><a href="http://vnoi.info/wiki/pages" class="action-all-pages">All</a></li>
  </ul>
</div>
<div id="wiki-content">
<div class="">
  <div id="wiki-body" class="gollum-markdown-content">
    <div class="markdown-body">
      

<p><strong>Tác giả</strong>: Lê Hùng Sơn - Đại học FPT</p>

<p></p><div class="toc"><div class="toc-title">Table of Contents</div><ul><li><a href="#giới-thiệu">Giới thiệu</a></li><li><a href="#ví-dụ-1-dãy-số-c11seq">Ví dụ 1: Dãy số (C11SEQ)</a><ul><li><a href="#ví-dụ-1-dãy-số-c11seq_Đề-bài">Đề bài</a></li><li><a href="#ví-dụ-1-dãy-số-c11seq_hướng-giải-quyết">Hướng giải quyết:</a></li></ul></li><li><a href="#ví-dụ-2-phân-đoạn-voi-2005-bảng-a">Ví dụ 2: Phân đoạn (VOI 2005 - Bảng A)</a><ul><li><a href="#ví-dụ-2-phân-đoạn-voi-2005-bảng-a_hướng-giải-quyết">Hướng giải quyết</a></li></ul></li></ul></div>

<h1><a class="anchor" id="giới-thiệu" href="#giới-thiệu"><i class="fa fa-link"></i></a>Giới thiệu</h1>

<p><strong>Rời rạc hóa</strong> là một lĩnh vực lớn có đối tượng nghiên 
cứu là các tập hợp rời rạc trong khoa học máy tính. Ứng dụng của của 
phương pháp rất lớn và thường được sử dụng trong rất nhiều kỳ thi lớn. 
Trong phạm vi chuyên đề ta chỉ xét một số ví dụ để hiểu rõ thêm phương 
pháp này.</p>

<p>Khi giải thuật lập trình ta hay quen gọi phương pháp rời rạc hóa là <strong>nén số</strong>. Thật vậy, đúng như tên gọi, bản chất của phương pháp ta hiểu nôm na là đưa các <em>vùng dữ liệu lớn</em> về <em>vùng dữ liệu nhỏ</em> để dễ xử lý, sao cho vẫn thỏa mãn yêu cầu của bài toán đặt ra.</p>

<p>Kỹ thuật bổ trợ trong phương pháp này là <em>đánh lại số thứ tự</em> hay còn được gọi là nén số, được thực hiện như sau:</p>

<ul>
<li> Giả sử ta nén số một mảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.358em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.084em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.181em, 1001.08em, 2.38em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.132em, 1000.73em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.75em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1">A_i</script> có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script> phần tử có giá trị thuộc khoảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 5.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.607em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1004.49em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-14" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><msup><mn>10</mn><mn>9</mn></msup><mo>,</mo><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">[-10^9, 10^9]</script> về mảng nhỏ hơn có giá trị thuộc khoảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.06em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1001.94em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-24" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">[1, n]</script> mà vẫn đảm bao được quan hệ lớn bé.</li>
</ul>

<p><strong>Ví dụ:</strong> a = {100, 100, 2000, 1500, 900000} → b = {1,1,3,2,4}</p>

<ul>
<li>  <em>B1:</em> Dùng 2 mảng <em>song song</em> <code>val[i] = a[i], pos[i] = i</code> (<code>pos</code> để lưu vị trí đi kèm giá trị <code>a[i]</code>)</li>
<li>  <em>B2:</em> Sắp xếp lại theo tăng dần của <code>val[ ]</code> chú ý khi <code>swap(val[i],val[j])</code> nhớ <code>swap(pos[i],pos[j])</code>.</li>
<li>  <em>B3:</em> Tạo một biến <code>dem = 0, last = max</code>, duyệt các giá trị <code>val[i]</code> nếu <code>last</code> khác <code>val[i]</code> thì: <code>dem++, last = val[i];</code> ở mỗi bước ta cập nhật <code>b[pos[i]] = dem</code>.</li>
</ul>

<p>Kết thúc quá trình trên, ta nhận được mảng <code>b[]</code> là nén từ mảng <code>a[]</code> với độ phức tạp thao tác nén này là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 6.995em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.691em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005.6em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">O(n*log(n))</script>.</p>

<h1><a class="anchor" id="ví-dụ-1-dãy-số-c11seq" href="#ví-dụ-1-dãy-số-c11seq"><i class="fa fa-link"></i></a>Ví dụ 1: Dãy số (C11SEQ)</h1>

<h2><a class="anchor" id="ví-dụ-1-dãy-số-c11seq_Đề-bài" href="#ví-dụ-1-dãy-số-c11seq_Đề-bài"><i class="fa fa-link"></i></a>Đề bài</h2>

<p>Cho n số nguyên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 5.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.119em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1004.02em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-46" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">(n \le 10^5)</script> số nguyên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 6.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.637em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.64em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="msubsup" id="MathJax-Span-52"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-56" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-58" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-62" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">a_1, a_2, \dots, a_n</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 6.019em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.878em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1004.78em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-68"><span class="mrow" id="MathJax-Span-69"><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-78" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-79" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>a</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">(|a_i| \le 10^9)</script> và 2 số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-82" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.67em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">L</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.243em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math; font-style: italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.092em; border-left: 0px solid; width: 0px; height: 0.999em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">R</script> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 4.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.523em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.43em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>L</mi><mo>≤</mo><mi>R</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">(L \le R)</script>. Hãy đếm xem có bao nhiêu cặp <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-95" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1001.86em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-96"><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">(i, j)</script> thỏa <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-102" style="width: 14.312em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.599em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.377em, 1011.6em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-106" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-110" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.752em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.167em;">+</span><span class="msubsup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.335em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>a</mi><mi>j</mi></msub><mo>≤</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">L \le a_i + a_{i+1} +... + a_j \le R</script>.</p>

<p>Input:</p>

<ul>
<li>  Dòng đầu chứa 3 số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.927em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.377em, 1002.92em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">L</span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.212em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>,</mo><mi>L</mi><mo>,</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">n, L, R</script>.</li>
<li>  Dòng 2 chứa <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-134" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-135"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">n</script> số nguyên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 6.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.637em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.64em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-143" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-149" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">a_1, a_2, \dots, a_n</script>.</li>
</ul>

<p>Output:</p>

<ul>
<li>  In ra kết quả cần tìm.</li>
</ul>

<p>Example:</p>

<pre class="highlight"><code>C11SEQ.INP

4 2 4
1 2 3 4

C11SEQ.OUT
4</code></pre>

<h2><a class="anchor" id="ví-dụ-1-dãy-số-c11seq_hướng-giải-quyết" href="#ví-dụ-1-dãy-số-c11seq_hướng-giải-quyết"><i class="fa fa-link"></i></a>Hướng giải quyết:</h2>

<ul>
<li>  Hướng đơn giản nhất là duyệt mọi cặp đoạn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-152" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1001.86em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">(i,j)</script> và kiểm tra xem tổng nó có thỏa không và ta tăng biến đếm lên. Tuy nhiên cách này mất chi phí thời gian <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-159" style="width: 3.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.226em, 1002.45em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-163"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.58em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.6em;"><span class="mn" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.466em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">O(n^2)</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 4.176em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.36em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1003.36em, 2.523em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-171" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.236em; border-left: 0px solid; width: 0px; height: 1.366em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-19">n \le 10^5</script> thì không được khả thi.</li>
<li>  Bây giờ ta thử gọi như sau: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-174" style="width: 12.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.81em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1009.81em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-175"><span class="msubsup" id="MathJax-Span-176"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-180" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-184" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.222em;">⋯</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-190" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">S_i = a_1 + a_2 + \dots + a_i</script>.</li>
<li>  Đoạn con <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-193" style="width: 6.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.932em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.84em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-194"><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-200" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">j</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">(</mo><mi>i</mi><mo>≥</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">(i,j) \, (i \ge j)</script> thỏa mãn điều kiện nếu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 10.03em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.13em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1008.13em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-210" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-212" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-214" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="texatom" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>≤</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>≤</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">L \le S_i - S_{j-1} \le R</script>. Biến đổi tiếp ta được 2 điều kiện để thỏa là:  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 7.428em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.016em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1006.02em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="msubsup" id="MathJax-Span-231" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi><mo>≥</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">S_i - L \ge S_{j-1}</script> và <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-238" style="width: 7.482em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.07em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1006.07em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-246" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi><mo>≤</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">S_i - R \le S_{j-1}</script>.</li>
</ul>

<p>Tiếp theo, ta có:</p>

<ul>
<li>Nhận xét 1: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-253" style="width: 7.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.341em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1006.34em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-254"><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-261" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-262" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.239em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi><mo>,</mo><mspace width="thinmathspace"></mspace><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">S_i - L, \, S_i - R</script> là 2 số cố định.</li>
<li><p>Nhận xét 2: Quan hệ &lt;= hay &gt;= cho ta thấy: không cần quan 
tâm giá trị của các số mà chỉ cần đảm bảo quan hệ &lt;= hay &gt;= là 
được. Ví dụ: 1 &lt; 5 ta có thể nén thành 1 &lt; 2 chả ảnh hưởng kết quả
 bài toán.</p></li>
<li><p>Nhận xét 3: Quá lắm chỉ có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-267" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.395em, 1001.99em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-268"><span class="mn" id="MathJax-Span-269" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.978em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>∗</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">3*n</script> phần tử cho tất cả các giá trị: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-272" style="width: 10.463em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.509em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1008.51em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-273"><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-275" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-280" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-286" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi><mo>,</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi><mo>,</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">S_i - L, S_i - R, S_{j-1}</script>, với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-293" style="width: 4.176em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.36em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1003.36em, 2.523em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-297" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-298" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.236em; border-left: 0px solid; width: 0px; height: 1.366em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-28">n \le 10^5</script> thì đây là con số nhỏ.</p></li>
</ul>

<p>Từ 3 nhận xét trên ta sẽ tìm cách đưa <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-300" style="width: 10.463em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.509em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1008.51em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-301"><span class="msubsup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-308" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-314" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="texatom" id="MathJax-Span-316"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-320" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi><mo>,</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi><mo>,</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">S_i - L, S_i - R, S_{j-1}</script> về các mảng nhỏ không quá <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-321" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.395em, 1001.99em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="mn" id="MathJax-Span-323" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.978em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>∗</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">3*n</script> phần tử để dễ dàng quản lý:</p>

<ul>
<li>  Ta lập một mảng mới có 3*n phần tử: n phần tử dạng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-326" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.192em, 1000.92em, 2.38em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="msubsup" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">S_i</script>, n dạng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 3.472em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.818em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1002.78em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="msubsup" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">S_i - L</script>, n dạng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-338" style="width: 3.526em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.873em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1002.87em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-339"><span class="msubsup" id="MathJax-Span-340"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">S_i - R</script>, nhớ lưu vị trí đi kèm.</li>
<li>  Bây giờ tiến hành sort mảng đó lại, và ta tiến hành đánh số lai mảng đó, gọi các mảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-345" style="width: 5.965em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.824em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.394em, 1004.82em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-346"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-348"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-349" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="msubsup" id="MathJax-Span-353"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.45em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-354" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="msubsup" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.46em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-359" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><msub><mn>1</mn><mi>i</mi></msub><mo>,</mo><mi>p</mi><msub><mn>2</mn><mi>i</mi></msub><mo>,</mo><mi>p</mi><msub><mn>3</mn><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">p1_i, p2_i, p3_i</script> là các giá trị sau khi đánh số lại của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-361" style="width: 9.271em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.534em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1007.53em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-367" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-373" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.239em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>,</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>L</mi><mo>,</mo><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">S_i, S_i - L, S_i - R</script>.</li>
<li>
<p>Ta tiến hành duyệt các vị trí i, dùng 1 cây <a class="internal present" href="http://vnoi.info/wiki/algo/data-structures/segment-tree-extend">Segment Tree</a> hoặc <a class="internal present" href="http://vnoi.info/wiki/algo/data-structures/fenwick">Binary Indexed Tree</a> để quản lý và đếm:</p>

<ul>
<li>B1: cập nhất kết quả: tăng res thêm số lượng phần tử đoạn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-378" style="width: 4.393em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.577em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.46em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-379"><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.183em, 1000.46em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-383" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.45em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-388" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>p</mi><msub><mn>3</mn><mi>i</mi></msub><mo>,</mo><mi>p</mi><msub><mn>2</mn><mi>i</mi></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">[p3_i, p2_i]</script> đã xuất hiện.</li>
<li>B2: thêm số lượng 1 phần tử <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msub&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 1.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.231em, 1001.3em, 2.416em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.819em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.43em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-395" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.5em;"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><msub><mn>1</mn><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">p1_i</script> vào cây.</li>
</ul>
</li>
<li><p>Độ phức tạp: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-397" style="width: 10.572em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.564em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1008.47em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-401" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-409" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>3</mn><mo>∗</mo><mi>n</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>3</mn><mo>∗</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">O(3 * n * log(3 * n))</script>.</p></li>
<li>  Ngoài cách này ra, ta còn 1 cách dùng <em>Phương pháp chia để trị</em>, sẽ có trong các tài liệu sắp tới.</li>
</ul>

<p>Code tham khảo (pascal):</p>

<pre class="highlight"><code><span class="c1">// Code phần nén số: 
// ở đây thay vì dùng 3 mảng p1[i], p2[i], p3[i] mình tận dụng luôn mảng a:
// * a[i] = p1[i], a[n + i] = p2[i], a[2*n + i] = p3[i]
</span><span class="k">procedure</span> <span class="n">unzip</span><span class="p">;</span>
<span class="k">var</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">del</span><span class="p">:</span><span class="kt">longint</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="n">sort</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">*</span><span class="n">n</span><span class="p">);</span>
    <span class="n">A</span><span class="p">[</span><span class="m">3</span><span class="p">*</span><span class="n">n</span><span class="p">+</span><span class="m">1</span><span class="p">].</span><span class="n">val</span><span class="p">:=</span><span class="n">high</span><span class="p">(</span><span class="kt">longint</span><span class="p">);</span>
    <span class="n">i</span><span class="p">:=</span><span class="m">1</span><span class="p">;</span>  <span class="n">del</span><span class="p">:=</span><span class="m">0</span><span class="p">;</span>
    <span class="k">repeat</span>
         <span class="k">inc</span><span class="p">(</span><span class="n">del</span><span class="p">);</span>
         <span class="n">j</span><span class="p">:=</span><span class="n">i</span><span class="p">;</span>
         <span class="k">while</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="p">=</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">val</span> <span class="k">do</span>
         <span class="k">begin</span>
             <span class="n">B</span><span class="p">[</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">pos</span><span class="p">]:=</span><span class="n">del</span><span class="p">;</span>
             <span class="k">inc</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
         <span class="k">end</span><span class="p">;</span>
         <span class="n">i</span><span class="p">:=</span><span class="n">j</span><span class="p">;</span>
    <span class="k">until</span> <span class="n">i</span><span class="p">=</span><span class="m">3</span><span class="p">*</span><span class="n">n</span><span class="p">+</span><span class="m">1</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="c1">// Phần tính toán kết quả bằng Binary Indexed Tree
</span><span class="k">for</span> <span class="n">i</span><span class="p">:=</span><span class="n">n</span> <span class="k">downto</span> <span class="m">2</span> <span class="k">do</span>
    <span class="k">begin</span>
        <span class="n">update</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">res</span><span class="p">:=</span><span class="n">res</span><span class="p">+</span><span class="n">get</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">-</span><span class="m">1</span><span class="p">+</span><span class="m">2</span><span class="p">*</span><span class="n">n</span><span class="p">])-</span><span class="n">get</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">-</span><span class="m">1</span><span class="p">+</span><span class="n">n</span><span class="p">]);</span>
    <span class="k">end</span><span class="p">;</span></code></pre>

<h1><a class="anchor" id="ví-dụ-2-phân-đoạn-voi-2005-bảng-a" href="#ví-dụ-2-phân-đoạn-voi-2005-bảng-a"><i class="fa fa-link"></i></a>Ví dụ 2: Phân đoạn (VOI 2005 - Bảng A)</h1>

<p>Cho dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">n</script> số nguyên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 6.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.637em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.64em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-423" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-429" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-40">a_1, a_2, \dots , a_n</script> và số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;15000&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;30000&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 18.106em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.688em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1014.59em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mspace" id="MathJax-Span-435" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-437" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">k</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mn" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.278em;">15000</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-445" style="height: 0em; vertical-align: 0em; width: 0.167em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-450"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="texatom" id="MathJax-Span-453"><span class="mrow" id="MathJax-Span-454"><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mn" id="MathJax-Span-457" style="font-family: MathJax_Main; padding-left: 0.278em;">30000</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mspace width="thinmathspace"></mspace><mo stretchy="false">(</mo><mn>1</mn><mo>≤</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo>≤</mo><mn>15000</mn><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>a</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><mn>30000</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41">k \, (1 \le n, k \le 15000) \, (|a_i| \le 30000)</script>
 hãy tìm số m nhỏ nhất sao cho có thể chia dãy đã cho thành k phần, mỗi 
phần là 1 đoạn các phân tử liên tiếp, và phải đảm bảo tổng mỗi phần 
không quá m.</p>

<p>Input:</p>

<ul>
<li>  Dòng đầu chứa số nguyên n và k.</li>
<li>  Dòng thứ 2 chứa n số nguyên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-459" style="width: 6.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.637em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.64em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-460"><span class="msubsup" id="MathJax-Span-461"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-465" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-467" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-471" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">a_1, a_2, \dots , a_n</script>.</li>
</ul>

<p>Output:</p>

<ul>
<li>  In ra số nguyên m.</li>
</ul>

<p>Example:</p>

<pre class="highlight"><code>QBSEGPAR.INP

9 4
1 1 1 3 2 2 1 3 1

QBSEGPAR.OUT

5</code></pre>

<h2><a class="anchor" id="ví-dụ-2-phân-đoạn-voi-2005-bảng-a_hướng-giải-quyết" href="#ví-dụ-2-phân-đoạn-voi-2005-bảng-a_hướng-giải-quyết"><i class="fa fa-link"></i></a>Hướng giải quyết</h2>

<p><strong>Nhận xét 1:</strong> Bài toán yêu cầu tìm m nhỏ nhất, theo 
kinh nghiệm thì khi bài toán bảo tìm giá trị nhỏ nhất hay lớn nhất nhưng
 không xác định được từ dữ liệu bài thì ta nên nghĩ đến <em>chặt nhị phân</em>. Vùng giá trị chặt có thể chọn từ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" style="width: 5.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.607em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1004.49em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-475"><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-479" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-482" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-483" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><msup><mn>10</mn><mn>9</mn></msup><mo>,</mo><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">[-10^9, 10^9]</script> là vừa hợp, cái này là tùy chọn, còn tối ưu nhất chỉ cần chặt trong khoảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 14.799em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.033em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1011.91em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-492" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">m</span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-505"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>−</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>∗</mo><mi>n</mi><mo>,</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>∗</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">[-max(a_i)* n, max(a_i)*n]</script>.</p>

<ul>
<li>  Tuy nhiên, ta chỉ dự đoán là chặt nhị phân nhưng chưa khẳng định 
là có đúng không, ta có nhận xét sau: _với m càng lớn thì việc chia 
thành k đoạn càng dễ _ → dùng chặt nhị phân là chính xác.</li>
</ul>

<p><strong>Nhận xét 2:</strong> Nếu ta có 1 giá trị m xác định, ta chia được ít nhất là a đoạn, chia nhiều nhất là b đoạn, nếu tồn tại k mà <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-512" style="width: 5.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.173em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1004.17em, 2.523em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">k</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.236em; border-left: 0px solid; width: 0px; height: 1.157em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">a \le k \le b</script> thì luôn có cách chia k đoạn thỏa mãn. Để xác định được a và b ta dùng phương pháp <em>Quy hoạch động</em>.</p>

<p><em>Chặt nhị phân</em> không khó, ở đây khó là phương pháp _quy hoạch động _cho thỏa mãn thời gian. Công thức sơ khai như sau:</p>

<ul>
<li>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-519" style="width: 12.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.81em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1009.81em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="msubsup" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-525" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-529" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main; padding-left: 0.222em;">⋯</span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-535" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">S_i = a_1 + a_2 + \dots + a_i</script>.</li>
<li>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-538" style="width: 3.526em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.873em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.192em, 1002.87em, 2.427em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-539"><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0.891em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.52em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.572em;"><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">fmax_i</script> = số đoạn chia được nhiều nhất trong dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-546" style="width: 6.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.42em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.42em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-547"><span class="msubsup" id="MathJax-Span-548"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-550" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-552" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-558" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">a_1, a_2, \dots , a_i</script>.</li>
<li>  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-561" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.192em, 1002.66em, 2.427em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="msubsup" id="MathJax-Span-566"><span style="display: inline-block; position: relative; width: 0.919em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.58em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.6em;"><span class="mi" id="MathJax-Span-568" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">fmin_i</script> = số đoạn chia được ít nhất trong dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-569" style="width: 6.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.42em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.619em, 1005.42em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-570"><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-574" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-575" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main; padding-left: 0.167em;">…</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-581" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 0.914em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">a_1, a_2, \dots , a_i</script>.</li>
</ul>

<p>Khởi tạo: <code>fmax[0] = 0, fmin[0] = 0, fmax[i] = -max (i != 0), fmin[i] = INF (i != 0)</code>.</p>

<p><em>Công thức:</em></p>

<ul>
<li>  <code>fmax[i] = max(fmax[i], fmax[j] + 1)</code> với <code>j &lt; i</code> và <code>S[i] - S[j] &lt;= m</code>.</li>
<li>  <code>fmin[i] = min(fmin[i], fmin[j] + 1)</code> với <code>j &lt; i</code> và <code>S[i] - S[j] &lt;= m</code>.</li>
</ul>

<p>Nhận thấy độ phức tạp đây là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-584" style="width: 10.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.401em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1008.31em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-587" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.58em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.6em;"><span class="mn" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-591" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-595" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-596" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-598" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-599" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">O(n^2 * log(2 * 10^9))</script>
 không thể đáp ứng được thời gian yêu cầu là 1s nhưng ở trường hợp quá 
bí ý tưởng đây không phải giải pháp tồi giúp lấy được một ít điểm lẻ.</p>

<p>Để nhanh được chỉ có cách là cải tiến sao cho tính mảng Quy hoạch động được nhanh, ở đây ta để ý quan hệ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-603" style="width: 6.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.312em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1005.29em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-609" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><msub><mi>S</mi><mi>j</mi></msub><mo>≤</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">S_i - S_j \le m</script> chỉ cần biến đổi thành <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 6.561em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.312em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1005.31em, 2.679em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-618" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="msubsup" id="MathJax-Span-622" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.429em; border-left: 0px solid; width: 0px; height: 1.362em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>m</mi><mo>≤</mo><msub><mi>S</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">S_i - m \le S_j</script> → giải pháp đã phần nào sáng sủa hơn và nếu tinh ý thì đây chỉ là bài toán 1 chiều, "một nửa" của <strong>ví dụ 1</strong> ở trên thôi → Bây giờ ta chỉ cần rời rạc hóa nó đi thay vì <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-625" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.395em, 1001.99em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-626"><span class="mn" id="MathJax-Span-627" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.978em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mo>∗</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">3 * n</script>, ta có mảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-630" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.394em, 1001.99em, 2.396em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-631"><span class="mn" id="MathJax-Span-632" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>∗</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">2 * n</script> lưu các giá trị <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-635" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.192em, 1000.92em, 2.38em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-636"><span class="msubsup" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">S_i</script> và <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-640" style="width: 3.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.981em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.355em, 1002.96em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-641"><span class="msubsup" id="MathJax-Span-642"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.65em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.613em;"><span class="mi" id="MathJax-Span-644" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.195em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub><mo>−</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">S_i - m</script>,
 ta sẽ tính dựa vào 1 cây Binary Indexed Tree cho đơn giản thay vì đếm 
như bài trên, vấn đề ở đây chỉ là tìm max min, và update max, min.</p>

<ul>
<li>  Độ phức tạp: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-647" style="width: 14.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.545em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1011.45em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-655" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-658" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-659" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-660" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-663" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-664" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-666" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-667" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">O(n * log(n) * log(2 * 10^9))</script>.</li>
</ul>

    </div>
  </div>


  </div>

</div>
<div id="footer">
  <p id="last-edit">Last edited by <b>Thanh Trung Nguyen</b>, 2017-11-10 00:34:24</p>

  <script async="" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/adsbygoogle.js"></script>
  <ins class="adsbygoogle" style="display: block; height: 460px;" data-ad-format="autorelaxed" data-ad-client="ca-pub-7999681867463377" data-ad-slot="5777921660" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:460px;margin:0;padding:0;position:relative;visibility:visible;width:920px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:460px;margin:0;padding:0;position:relative;visibility:visible;width:920px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:920px;height:460px;" width="920" height="460" frameborder="0"></iframe></ins></ins></ins>
  <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <hr><br>
  <div class="fb-like fb_iframe_widget" data-href="/wiki/algo/trick/Roi-rac-hoa-va-ung-dung" data-width="1080" data-layout="button_count" data-action="like" data-size="large" data-show-faces="true" data-share="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=449532395210446&amp;container_width=920&amp;href=http%3A%2F%2Fvnoi.info%2Fwiki%2Falgo%2Ftrick%2FRoi-rac-hoa-va-ung-dung&amp;layout=button_count&amp;locale=en_GB&amp;sdk=joey&amp;share=true&amp;show_faces=true&amp;size=large&amp;width=1080"><span style="vertical-align: bottom; width: 138px; height: 28px;"><iframe name="f29cc392b57ac4c" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 138px; height: 28px;" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/like.html" class="" width="1080px" height="1000px" frameborder="0"></iframe></span></div>
  <div class="fb-save fb_iframe_widget" data-uri="/wiki/algo/trick/Roi-rac-hoa-va-ung-dung" data-size="large" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=449532395210446&amp;container_width=920&amp;locale=en_GB&amp;sdk=joey&amp;size=large&amp;uri=http%3A%2F%2Fvnoi.info%2Fwiki%2Falgo%2Ftrick%2FRoi-rac-hoa-va-ung-dung"><span style="vertical-align: bottom; width: 146px; height: 28px;"><iframe name="f2f456d4c1dec46" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:save Facebook Social Plugin" style="border: medium none; visibility: visible; width: 146px; height: 28px;" src="R%E1%BB%9Di%20r%E1%BA%A1c%20ho%C3%A1%20v%C3%A0%20%E1%BB%A9ng%20d%E1%BB%A5ng_files/save.html" class="" width="1000px" height="1000px" frameborder="0"></iframe></span></div>
  <br>
  <div class="fb-comments fb_iframe_widget fb_iframe_widget_fluid" data-href="vnoi.info//wiki/algo/trick/Roi-rac-hoa-va-ung-dung" data-width="100%" data-numposts="5" fb-xfbml-state="rendered"><span style="height: 180px;"><iframe id="f274797d1bafbca" name="ff7e4306f2f466" scrolling="no" style="border: medium none; overflow: hidden; height: 180px; width: 100%;" title="Facebook Social Plugin" class="fb_ltr" src="https://www.facebook.com/plugins/comments.php?api_key=449532395210446&amp;channel_url=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2F1e2RywyANNe.js%3Fversion%3D42%23cb%3Df2ded4b4f2eaac%26domain%3Dvnoi.info%26origin%3Dhttp%253A%252F%252Fvnoi.info%252Ff57af90bccd8c%26relation%3Dparent.parent&amp;href=vnoi.info%2F%2Fwiki%2Falgo%2Ftrick%2FRoi-rac-hoa-va-ung-dung&amp;locale=en_GB&amp;numposts=5&amp;sdk=joey&amp;version=v2.7&amp;width=100%25"></iframe></span></div>

</div>
</div>

<form name="rename" method="POST" action="/wiki/rename/algo/trick/Roi-rac-hoa-va-ung-dung">
  <input name="rename" type="hidden">
  <input name="message" type="hidden">
</form>




<ins class="adsbygoogle adsbygoogle-noablate" style="display: none;" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:NaNpx;margin:0;padding:0;position:relative;visibility:visible;width:NaNpx;background-color:transparent;"><ins id="aswift_0_anchor" style="display:block;border:none;height:NaNpx;margin:0;padding:0;position:relative;visibility:visible;width:NaNpx;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:NaNpx;height:NaNpx;" frameborder="0"></iframe></ins></ins></ins><iframe id="google_osd_static_frame_1548360738818" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Main, sans-serif;"></div></div></body></html>