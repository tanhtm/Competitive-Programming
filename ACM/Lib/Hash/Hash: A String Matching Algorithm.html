<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-type" content="text/html; charset=UTF-8">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="Hash:%20A%20String%20Matching%20Algorithm_files/gollum.css" media="all">
  <link rel="stylesheet" type="text/css" href="Hash:%20A%20String%20Matching%20Algorithm_files/editor.css" media="all">
  <link rel="stylesheet" type="text/css" href="Hash:%20A%20String%20Matching%20Algorithm_files/dialog.css" media="all">
  <link rel="stylesheet" type="text/css" href="Hash:%20A%20String%20Matching%20Algorithm_files/template.css" media="all">
  <link rel="stylesheet" type="text/css" href="Hash:%20A%20String%20Matching%20Algorithm_files/print.css" media="print">
  
  

  <!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="/wiki/css/ie7.css" media="all">
  <![endif]-->

  <script src="Hash:%20A%20String%20Matching%20Algorithm_files/osd.js"></script><script src="Hash:%20A%20String%20Matching%20Algorithm_files/ca-pub-7999681867463377.js"></script><script id="facebook-jssdk" src="Hash:%20A%20String%20Matching%20Algorithm_files/sdk.js"></script><script async="" src="Hash:%20A%20String%20Matching%20Algorithm_files/analytics.js"></script><script>
      var baseUrl = '/wiki';
      var uploadDest   = '';
      var pageFullPath = 'algo/string/hash';
  </script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/jquery-1.js"></script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/mousetrap.js"></script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/gollum_004.js"></script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/gollum_002.js"></script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/gollum_003.js"></script>
  <script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/gollum.js"></script>
  <script type="text/javascript">
  window.MathJax = {
    tex2jax: {
      inlineMath:  [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
      processEscapes: true
    },
    TeX: { extensions: ["autoload-all.js"] }
  };
  </script>
  <script>(function(d,j){
  j = d.createElement('script');
  j.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  (d.head || d.getElementsByTagName('head')[0]).appendChild(j);
  }(document));
  </script><script src="Hash:%20A%20String%20Matching%20Algorithm_files/MathJax.js"></script>
  

  <title>Hash: A String Matching Algorithm</title>
  <!-- Google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-61806804-1', 'auto');
    ga('send', 'pageview');

  </script>

  <script async="" src="Hash:%20A%20String%20Matching%20Algorithm_files/adsbygoogle.js"></script>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7999681867463377",
      enable_page_level_ads: true
  });
  </script>
<link rel="preload" href="Hash:%20A%20String%20Matching%20Algorithm_files/integrator_002.js" as="script"><script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/integrator_002.js"></script><link rel="preload" href="Hash:%20A%20String%20Matching%20Algorithm_files/integrator.js" as="script"><script type="text/javascript" src="Hash:%20A%20String%20Matching%20Algorithm_files/integrator.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_SansSerif; src: url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff?V=2.7.1') format('woff'), url('http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:-webkit-sticky;top:0}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in_v1{animation-duration:250ms;animation-name:fb_bounce_in_v1}.fb_customer_chat_bounce_out_v1{animation-duration:250ms;animation-name:fb_bounce_out_v1}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_in_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_out_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bubble_pop_in{animation-duration:250ms;animation-name:fb_customer_chat_bubble_bounce_in_animation}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_bounce_in_v1{0%{opacity:0;transform:scale(.8, .8);transform-origin:bottom right}80%{opacity:.8;transform:scale(1.03, 1.03)}100%{opacity:1;transform:scale(1, 1)}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_v2_mobile_chat_started{0%{opacity:0;top:20px}100%{opacity:1;top:0}}@keyframes fb_bounce_out_v1{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}</style></head>

<body class="ff"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
    <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="http://staticxx.facebook.com/connect/xd_arbiter/r/LnGK1eIuZ8c.js?version=42#channel=f3c27db3424db44&amp;origin=http%3A%2F%2Fvnoi.info" frameborder="0"></iframe><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="Hash:%20A%20String%20Matching%20Algorithm_files/LnGK1eIuZ8c_002.html" frameborder="0"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fdc3b7706730f4" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" style="display: none;" src="Hash:%20A%20String%20Matching%20Algorithm_files/ping.html" frameborder="0"></iframe></div></div></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.7&appId=449532395210446";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
<script>
Mousetrap.bind(['e'], function( e ) {
  e.preventDefault();
  window.location = "/edit" + window.location.pathname;
  return false;
});
</script>
<div id="wiki-wrapper" class="page">
<div id="head">
  <h1>Hash: A String Matching Algorithm</h1>
  <ul class="actions">
    <li class="minibutton">
      <div id="searchbar">
        <form action="/wiki/search" method="get" id="search-form">
        <div id="searchbar-fauxtext">
          <input name="q" id="search-query" value="Search…" autocomplete="off" class="ph" type="text">
          <a href="#" id="search-submit" title="Search this wiki">
            <span>Search</span>
          </a>
        </div>
        </form>
      </div>    </li>
    <li class="minibutton"><a href="http://vnoi.info/wiki/" class="action-home-page">Home</a></li>
    <li class="minibutton"><a href="http://vnoi.info/wiki/pages" class="action-all-pages">All</a></li>
  </ul>
</div>
<div id="wiki-content">
<div class="">
  <div id="wiki-body" class="gollum-markdown-content">
    <div class="markdown-body">
      

<p><strong>Tác giả</strong>: Lê Khắc Minh Tuệ</p>

<p><strong>Chỉnh sửa</strong>: Nguyễn <em>RR</em> Thành Trung, Phạm Văn Hạnh</p>

<p></p><div class="toc"><div class="toc-title">Table of Contents</div><ul><li><a href="#giới-thiệu">Giới thiệu</a><ul><li><a href="#giới-thiệu_hoàn-cảnh">Hoàn cảnh</a></li><li><a href="#giới-thiệu_phát-biểu-bài-toán">Phát biểu bài toán</a></li><li><a href="#giới-thiệu_thuật-toán">Thuật toán:</a></li><li><a href="#giới-thiệu_mục-đích-bài-viết">Mục đích bài viết</a></li></ul></li><li><a href="#thuật-toán-hash">Thuật toán Hash</a><ul><li><a href="#thuật-toán-hash_ký-hiệu">Ký hiệu</a></li><li><a href="#thuật-toán-hash_mô-tả-thuật-toán">Mô tả thuật toán</a></li><li><a href="#thuật-toán-hash_mã-chương-trình">Mã chương trình</a></li><li><a href="#thuật-toán-hash_Đánh-giá">Đánh giá</a></li></ul></li><li><a href="#chi-tiết-cài-đặt">Chi tiết cài đặt</a><ul><li><a href="#chi-tiết-cài-đặt_1-chọn-số-nguyên-tố-cho-hệ-cơ-số-và-modulo">1. Chọn số nguyên tố cho hệ cơ số và modulo</a></li><li><a href="#chi-tiết-cài-đặt_2-chọn-hệ-cơ-số">2. Chọn hệ cơ số</a></li><li><a href="#chi-tiết-cài-đặt_3-chọn-modulo">3. Chọn modulo</a></li><li><a href="#chi-tiết-cài-đặt_4-hash-tràn-số-và-hash-có-mod">4. Hash tràn số và Hash có MOD</a></li><li><a href="#chi-tiết-cài-đặt_5-một-số-lời-khuyên-nho-nhỏ">5. Một số lời khuyên nho nhỏ</a></li></ul></li><li><a href="#Ứng-dụng">Ứng dụng</a><ul><li><a href="#Ứng-dụng_longest-palindrome-substring">Longest palindrome substring</a></li><li><a href="#Ứng-dụng_k-th-alphabetical-cyclic">k-th alphabetical cyclic</a></li><li><a href="#Ứng-dụng_longest-substring-and-appear-at-least-k-times">Longest substring and appear at least k times</a></li></ul></li><li><a href="#Đánh-giá-độ-chính-xác">Đánh giá độ chính xác</a><ul><li><a href="#Đánh-giá-độ-chính-xác_trường-hợp-1">Trường hợp 1</a></li><li><a href="#Đánh-giá-độ-chính-xác_trường-hợp-2">Trường hợp 2</a></li></ul></li><li><a href="#tổng-kết">Tổng kết</a><ul><li><a href="#tổng-kết_thuật-toán">Thuật toán</a></li><li><a href="#tổng-kết_cài-đặt">Cài đặt</a></li><li><a href="#tổng-kết_Ưu-điểm">Ưu điểm</a></li><li><a href="#tổng-kết_nhược-điểm">Nhược điểm</a></li></ul></li><li><a href="#bài-tập-áp-dụng">Bài tập áp dụng</a></li><li><a href="#các-nguồn-tham-khảo">Các nguồn tham khảo</a></li></ul></div>

<h1><a class="anchor" id="giới-thiệu" href="#giới-thiệu"><i class="fa fa-link"></i></a>Giới thiệu</h1>

<h2><a class="anchor" id="giới-thiệu_hoàn-cảnh" href="#giới-thiệu_hoàn-cảnh"><i class="fa fa-link"></i></a>Hoàn cảnh</h2>

<p>Một lớp những bài toán rất được quan tâm trong khoa học máy tính nói chung và lập trình thi cử nói riêng, đó là <a class="internal present" href="http://vnoi.info/wiki/algo/string/basic">xử lý xâu chuỗi</a>. Trong lớp bài toán này, người ta thường rất hay phải đối mặt với một bài toán: tìm kiếm xâu chuỗi.</p>

<h2><a class="anchor" id="giới-thiệu_phát-biểu-bài-toán" href="#giới-thiệu_phát-biểu-bài-toán"><i class="fa fa-link"></i></a>Phát biểu bài toán</h2>

<ul>
<li>Cho một đoạn văn bản, gồm <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.867em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.85em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">m</script> ký tự.</li>
<li>Cho một đoạn mẫu, gồm <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script> ký tự.</li>
<li>Máy tính cần trả lời câu hỏi: đoạn mẫu xuất hiện bao nhiêu lần trong đoạn văn bản và chỉ ra các vị trí xuất hiện đó.</li>
</ul>

<h2><a class="anchor" id="giới-thiệu_thuật-toán" href="#giới-thiệu_thuật-toán"><i class="fa fa-link"></i></a>Thuật toán:</h2>

<p>Có rất nhiều thuật toán có thể giải quyết bài toán này. Người viết 
xin tóm tắt 2 thuật toán phổ biến được dùng trong các kì thi lập trình:</p>

<ul>
<li>
<strong>Brute-force</strong>: Với một cách tiếp cận trực tiếp, chúng ta 
có thể thu được thuật toán để giải. Tuy nhiên độ phực tạp của nó là rất 
lớn trong trường hợp xấu nhất. Thuật toán brute-force so khớp tất cả các
 vị trí xuất hiện của đoạn mẫu trong đoạn văn bản. Cụ thể độ phức tạp 
cho thuật toán này là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 3.688em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.981em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.89em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">O(mn)</script>.</li>
<li> <strong><a class="internal present" href="http://vnoi.info/wiki/translate/wcipeg/kmp">Knuth-Morris-Pratt</a></strong>:
 Hay còn được viết tắt là KMP, được phát minh vào năm 1974, bởi Donald 
Knuth, Vaughan Pratt và James H. Morris.  Thuật toán này sử dụng một 
correction-array, là một thuật toán rất hiệu quả, có độ phức tạp là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-14" style="width: 5.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.173em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.08em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">O(m + n)</script>.</li>
</ul>

<h2><a class="anchor" id="giới-thiệu_mục-đích-bài-viết" href="#giới-thiệu_mục-đích-bài-viết"><i class="fa fa-link"></i></a>Mục đích bài viết</h2>

<p>Trong bài viết này, người viết chỉ tập trung vào thuật toán Hash (Tên chuẩn của thuật toán này là <a href="https://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_algorithm">Rabin–Karp</a> hoặc <a href="https://en.wikipedia.org/wiki/Rolling_hash">Rolling Hash</a>,
 tuy nhiên ở Việt Nam thường được gọi là Hash). Theo như bản thân người 
viết đánh giá, đây là thuật toán rất hiệu quả đặc biệt là trong thi cử. 
Nó hiệu quả bởi 3 yếu tố: tốc độ thực thi, linh động trong việc sử dụng 
(ứng dụng hiệu quả) và sự đơn giản trong cài đặt.</p>

<p>Đầu tiên, người viết xin được trình bày về thuật toán này. Sau đó, 
người viết sẽ trình bày một vài ứng dụng, cách sử dụng và phát triển 
thuật toán Hash trong các bài toán tin học.</p>

<h1><a class="anchor" id="thuật-toán-hash" href="#thuật-toán-hash"><i class="fa fa-link"></i></a>Thuật toán Hash</h1>

<h2><a class="anchor" id="thuật-toán-hash_ký-hiệu" href="#thuật-toán-hash_ký-hiệu"><i class="fa fa-link"></i></a>Ký hiệu</h2>

<ul>
<li>Tập hợp các chữ cái được sử dụng: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.377em, 1000.65em, 2.385em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Main;">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\Sigma</script></li>
<li>Đoạn con từ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.236em, 1000.28em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.96em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">i</script> đến <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.236em, 1000.43em, 2.426em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.318em; border-left: 0px solid; width: 0px; height: 1.197em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">j</script> của một xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">s</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.54em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">s[i..j]</script></li>
<li>Đoạn văn bản: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 3.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.144em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.03em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main;">1..</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>m</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">T[1..m]</script></li>
<li>Đoạn mẫu: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.927em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.81em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main;">1..</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">P[1..n]</script></li>
</ul>

<p>Chúng ta cần tìm ra tất cả các vị trí <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 10.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.889em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1008.79em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-61" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo stretchy="false">(</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>m</mi><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">i (1 \le i \le m − n + 1)</script> thỏa  mãn: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 10.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.347em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1008.35em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">i</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-82" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">T[i..i+n−1] = P</script>.</p>

<h2><a class="anchor" id="thuật-toán-hash_mô-tả-thuật-toán" href="#thuật-toán-hash_mô-tả-thuật-toán"><i class="fa fa-link"></i></a>Mô tả thuật toán</h2>

<p>Để đơn giản, giả sử rằng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 7.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.125em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1006.13em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Main;">Σ</span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-90" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.226em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-14">\Sigma = {a, b, ..., z}</script> (nói cách khác, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.377em, 1000.65em, 2.385em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Main;">Σ</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\Sigma</script>
 chỉ gồm các chữ cái in thường). Để biểu diễn một xâu, thay vì dùng chữ 
cái, chúng ta sẽ chuyển sang biểu diễn dạng số. Ví dụ: xâu <code>aczd</code> được viết dưới dạng số là một dãy gồm 4 số: <code>(1,3,26,4)</code>. Như vậy, một xâu được biểu diễn dưới dạng một số ở hệ cơ số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1001.91em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">base</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;26&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" style="width: 5.206em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.228em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1004.18em, 2.425em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mn" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.278em;">26</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.116em; border-left: 0px solid; width: 0px; height: 1.036em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>&gt;</mo><mn>26</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">base > 26</script>. Từ đây suy ra, 2 xâu bằng nhau khi và chỉ khi biểu diễn của 2 xâu ở hệ cơ số 10 giống nhau.</p>

<p><strong>Lưu ý</strong>:</p>

<ol>
<li>Ở đây mình đổi chữ <code>a</code> thành số 1 chứ không phải số 0. Đây là chi tiết vô cùng quan trọng, để tránh 2 xâu: <code>abc</code> và <code>bc</code> bằng nhau khi đổi ra số. Bạn có thể đọc thêm chi tiết ở phần <a href="#chi-ti%E1%BA%BFt-c%C3%A0i-%C4%91%E1%BA%B7t">Chi tiết cài đặt</a>.</li>
<li>Thông thường ta chọn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1001.91em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">base</script> là một số nguyên tố. Mình sẽ giải thích thêm trong phần <a href="#chi-ti%E1%BA%BFt-c%C3%A0i-%C4%91%E1%BA%B7t">Chi tiết cài đặt</a>.</li>
</ol>

<p>Đây chính là tư tưởng của thuật toán: đổi 2 xâu từ hệ cơ số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1001.91em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">base</script>
 ra hệ cơ số 10, rồi đem so sánh ở hệ cơ số 10. Tuy nhiên, chúng ta nhận
 thấy rằng, khi đổi 1 xâu ra biểu diễn ở hệ cơ số 10, biểu diễn này có 
thể rất lớn và nằm ngoài phạm vi lưu trữ số nguyên của máy tính.</p>

<p>Để khắc phục điều này, chúng ta chuyển sang so sánh 2 biểu diễn của 2
 xâu ở hệ cơ số 10 sau khi lấy phần dư cho một số nguyên đủ lớn. Cụ thể 
hơn: nếu biểu diễn trong hệ thập phân của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">a</script> là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.55em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">x</script> và biểu diễn trong hệ thập phân của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">b</script> là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.49em, 2.427em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.929em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">y</script>, chúng ta sẽ coi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">a</script> bằng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-145" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">b</script> <em>‘khi và chỉ khi’</em> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-148" style="width: 15.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.466em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.356em, 1012.44em, 2.59em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.251em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi><mo>=</mo><mi>y</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">x \bmod MOD = y \bmod MOD</script> trong đó <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">MOD</script> là một số nguyên đủ lớn.</p>

<p><strong>Lưu ý</strong>: Lý do chọn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-166" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">MOD</script> là số nguyên tố được giải thích thêm trong phần <a href="#chi-ti%E1%BA%BFt-c%C3%A0i-%C4%91%E1%BA%B7t">Chi tiết cài đặt</a>.</p>

<p>Dễ dàng nhận thấy việc so sánh <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 6.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.637em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.356em, 1005.61em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">x \bmod MOD</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-178" style="width: 6.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.528em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.356em, 1005.5em, 2.59em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-179"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.251em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">y \bmod MOD</script> rồi kết luận <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">a</script> có bằng với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-188" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">b</script> hay không là sai. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 15.341em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.466em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.356em, 1012.44em, 2.59em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.251em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi><mo>=</mo><mi>y</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">x \bmod MOD = y \bmod MOD</script> chỉ là điều kiện cần để <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-204" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">a</script> bằng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">b</script>
 chứ chưa phải điều  kiện đủ. Tuy nhiên, chúng ta sẽ chấp nhận lập luận 
sai này trong thuật toán Hash. Và coi điều kiện cần như điều kiện đủ. 
Trên thực tế, lập luận sai này có thể dẫn đến kết quả sai nếu bạn không 
hiểu rõ mình đang làm gì. Để hiểu rõ về tỉ lệ sai của thuật toán Hash, 
các bạn đọc thêm phần <a href="#%C4%90%C3%A1nh-gi%C3%A1-%C4%91%E1%BB%99-ch%C3%ADnh-x%C3%A1c">Đánh giá độ chính xác</a>. Phần <a href="#chi-ti%E1%BA%BFt-c%C3%A0i-%C4%91%E1%BA%B7t">Chi tiết cài đặt</a> cũng nói thêm về cách tránh bị sai số khi cài đặt Hash.</p>

<p>Để đơn giản trong việc trình bày tiếp thuật toán, chúng ta sẽ gọi 
biểu diễn của một xâu trong hệ thập phân sau khi lấy phần dư cho <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">MOD</script> là mã Hash của xâu đó. Nhắc lại, 2 xâu bằng nhau <em>‘khi và chỉ khi’</em> mã Hash của 2 xâu bằng nhau.</p>

<p>Trở lại bài toán ban đầu, chúng ta cần chỉ ra <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-215" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">P</script> xuất hiện ở những vị trí nào trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-218" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.22em, 1000.71em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">T</script>. Để làm được việc này, chúng ta chỉ cần duyệt qua mọi vị trí xuất phát có thể của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">P</script> trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.22em, 1000.71em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">T</script>. Giả sử vị trí đó là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-227" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.236em, 1000.28em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.96em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">i</script>, chúng ta sẽ kiểm tra <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-230" style="width: 7.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.287em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.17em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">i</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-241" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">T[i..i+n−1]</script> có bằng với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">P</script> hay không. Để kiểm tra điều này, chúng ta cần tính được mã Hash của đoạn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-246" style="width: 7.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.287em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.17em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">i</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-257" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>i</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">T[i..i+n−1]</script> và mã Hash của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-259" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-260"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">P</script>.</p>

<p>Để tính mã Hash của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-262" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">P</script> chúng ta chỉ cần làm đơn giản như sau:</p>

<pre class="highlight"><code>const base = 31;
hashP = 0
for (i : 1 .. n)
      hashP = (hashP * base + P[i] - 'a' + 1) mod MOD</code></pre>

<p>Phần khó hơn của thuật toán Hash là: Tính mã Hash của một đoạn con <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-265" style="width: 3.526em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.873em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.75em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-266"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-47">T[i..j]</script> của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-274" style="width: 0.87em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.705em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.22em, 1000.71em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">T</script> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" style="width: 8.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.829em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.73em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-280" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">j</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">(1 \le i \le j \le N)</script>.</p>

<ul>
<li>Để hình dung cho đơn giản, xét ví dụ sau: Xét xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">s</script> và biểu diễn của nó dưới cơ số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-291" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1001.91em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">base</script>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-297" style="width: 8.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.829em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.73em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-298"><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-300" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.167em;">2</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.167em;">7</span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.167em;">8</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>8</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">(4,1,2,5,1,7,8)</script>. Chúng ta cần lấy mã Hash của đoạn con từ phần tử thứ 3 đến phần tử thứ 6, nghĩa là cần lấy mã Hash của xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 4.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.011em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.92em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-317" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-321" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-323" style="font-family: MathJax_Main; padding-left: 0.167em;">7</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>7</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">(2,5,1,7)</script>. Nhận thấy, để lấy được xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3..6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-325" style="width: 3.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.43em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-329" style="font-family: MathJax_Main;">3..6</span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>3..6</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-54">s[3..6]</script>, chỉ cần lấy số <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 3.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.43em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-335" style="font-family: MathJax_Main;">1..6</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>1..6</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">s[1..6]</script> là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 7.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.854em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005.76em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-340" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-344" style="font-family: MathJax_Main; padding-left: 0.167em;">2</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-348" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.167em;">7</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>7</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">(4,1,2,5,1,7)</script> trừ cho số (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" style="width: 3.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.43em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-356" style="font-family: MathJax_Main;">1..2</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>1..2</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-57">s[1..2]</script> nhân với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 2.93em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.385em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.055em, 1002.39em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="msubsup" id="MathJax-Span-363"><span style="display: inline-block; position: relative; width: 0.895em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.43em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.466em;"><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.182em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><msup><mi>e</mi><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-58">base^4</script>) là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-366" style="width: 7.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.854em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005.76em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-369" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-371" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-373" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-375" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-379" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">(4,1,0,0,0,0)</script> ta sẽ thu được <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-381" style="width: 4.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.011em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.92em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-382"><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-384" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-386" style="font-family: MathJax_Main; padding-left: 0.167em;">5</span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-388" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-390" style="font-family: MathJax_Main; padding-left: 0.167em;">7</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>2</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>7</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-60">(2,5,1,7)</script>.</li>
<li>Để cài đặt ý tưởng này, chúng ta cần khởi tạo <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-392" style="width: 9.163em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.425em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.356em, 1007.4em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="msubsup" id="MathJax-Span-397"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.43em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-398" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.466em;"><span class="mi" id="MathJax-Span-399" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><msup><mi>e</mi><mi>x</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">base^x \bmod MOD</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" style="width: 6.615em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.366em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005.27em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-407" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">(0 \le x \le m)</script> và mã Hash của tất cả những tiền tố của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">s</script>, cụ thể là mã Hash của những xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-416" style="width: 2.93em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.385em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.27em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-420" style="font-family: MathJax_Main;">1..</span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-64">s[1..i]</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" style="width: 6.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.095em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-426" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-65">(1 \le i \le m)</script>.</li>
</ul>

<pre class="highlight"><code>pow[0] = 1
for (i : 1 .. m)
       pow[i] = (pow[i-1] * base) mod MOD


hashT[0] = 0
for (i : 1 .. m)
       hashT[i] = (hashT[i-1] * base + T[i] - 'a') mod MOD
</code></pre>

<p>Trong đoạn code trên, chúng ta thu được mảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-432" style="width: 3.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.547em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.43em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>o</mi><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">pow[i]</script> (lưu lại <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-440" style="width: 8.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.263em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.229em, 1007.24em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.43em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.466em;"><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.182em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><msup><mi>e</mi><mi>i</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">base^i \bmod MOD</script>) và mảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-452" style="width: 4.664em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.794em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1003.68em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">hashT[i]</script> (lưu lại mã Hash của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-462" style="width: 3.201em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.602em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.48em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-466" style="font-family: MathJax_Main;">1..</span><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">T[1..i]</script>).</p>

<ul>
<li>Để lấy mã Hash của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-469" style="width: 3.526em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.873em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.75em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">T[i..j]</script> ta viết hàm sau:</li>
</ul>

<pre class="highlight"><code>function getHashT(i, j):
       return (hashT[j] - hashT[i - 1] * pow[j - i + 1] + MOD * MOD) mod MOD
</code></pre>

<p>Bài toán chính đã được giải quyết, và đây là chương trình chính:</p>

<pre class="highlight"><code>for (i : 1 .. m - n +1)
      if hashP = getHashT(i, i + n - 1):
              print("Match position: ", i)</code></pre>

<h2><a class="anchor" id="thuật-toán-hash_mã-chương-trình" href="#thuật-toán-hash_mã-chương-trình"><i class="fa fa-link"></i></a>Mã chương trình</h2>

<p>Chương trình sau, tôi viết bằng ngôn ngữ C++, là lời giải cho bài <a href="http://vnoi.info/problems/show/SUBSTR">SUBSTR</a>:</p>

<pre class="highlight"><code><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">base</span> <span class="o">=</span> <span class="mi">31</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mi">1000000003</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mi">1000111</span><span class="p">;</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">ll</span> <span class="n">POW</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span> <span class="n">hashT</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>


<span class="n">ll</span> <span class="nf">getHashT</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="kt">int</span> <span class="n">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">hashT</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">hashT</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">POW</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD</span> <span class="o">*</span> <span class="n">MOD</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Input
</span>    <span class="n">string</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">T</span> <span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">;</span>

    <span class="c1">// Initialize
</span>    <span class="kt">int</span> <span class="n">lenT</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">lenP</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">T</span> <span class="o">=</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">T</span><span class="p">;</span>
    <span class="n">P</span> <span class="o">=</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">P</span><span class="p">;</span>
    <span class="n">POW</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Precalculate base^i
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lenT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    	<span class="n">POW</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">POW</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">base</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>

    <span class="c1">// Calculate hash value of T[1..i]
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lenT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    	<span class="n">hashT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">hashT</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">base</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">'a'</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>

    <span class="c1">// Calculate hash value of P
</span>    <span class="n">ll</span> <span class="n">hashP</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lenP</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    	<span class="n">hashP</span> <span class="o">=</span> <span class="p">(</span><span class="n">hashP</span> <span class="o">*</span> <span class="n">base</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">'a'</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>

    <span class="c1">// Finding substrings of T equal to string P
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lenT</span> <span class="o">-</span> <span class="n">lenP</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    	<span class="k">if</span> <span class="p">(</span><span class="n">hashP</span> <span class="o">==</span> <span class="n">getHashT</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">lenP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    		<span class="n">printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
<span class="p">}</span></code></pre>

<h2><a class="anchor" id="thuật-toán-hash_Đánh-giá" href="#thuật-toán-hash_Đánh-giá"><i class="fa fa-link"></i></a>Đánh giá</h2>

<p>Độ phức tạp của thuật toán là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 5.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.173em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.08em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">O(m + n)</script>. Nhưng điều quan trọng là: chúng ta có thể kiểm tra 2 xâu có giống nhau hay không trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1001.91em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-490" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">O(1)</script>.
 Đây là điều tạo nên sự linh động cho thuật toán Hash. Ngoài sự linh 
động và tốc độ thực thi, chúng ta có thể thấy cài đặt thuật toán này 
thực sự rất đơn giản nếu so với các thuật toán xử lý xâu khác.</p>

<h1><a class="anchor" id="chi-tiết-cài-đặt" href="#chi-tiết-cài-đặt"><i class="fa fa-link"></i></a>Chi tiết cài đặt</h1>

<p>Trong thuật toán hash, có hai yếu tố cần quan tâm là hệ cơ số (base) và modulo (mod).</p>

<h2><a class="anchor" id="chi-tiết-cài-đặt_1-chọn-số-nguyên-tố-cho-hệ-cơ-số-và-modulo" href="#chi-tiết-cài-đặt_1-chọn-số-nguyên-tố-cho-hệ-cơ-số-và-modulo"><i class="fa fa-link"></i></a>1. Chọn số nguyên tố cho hệ cơ số và modulo</h2>

<p>Ý tưởng của thuật toán Hash là dựa trên một ngộ nhận sai lầm nhưng xảy ra sai sót với xác suất vô cùng nhỏ: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;&amp;lt;=&amp;gt;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 17.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.309em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1014.3em, 2.425em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span><span class="mo" id="MathJax-Span-499" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span><span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">&gt;</span></span><span class="mi" id="MathJax-Span-502" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.116em; border-left: 0px solid; width: 0px; height: 1.036em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mo>=</mo><mi>b</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>M</mi><mo>&lt;=&gt;</mo><mi>a</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">a \bmod M = b \bmod M <=> a = b</script>. Để xác suất xảy ra sai là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-505" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.06em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.06em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-506"><span class="mn" id="MathJax-Span-507" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-508"><span class="mrow" id="MathJax-Span-509"><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">1/M</script> cho một truy vấn, các bạn cần chọn hệ cơ số và modulo thỏa mãn đồng thời:</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-512" style="width: 2.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1001.91em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">base</script> là số nguyên tố lớn hơn các chữ cái của xâu <code>S</code>.</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-518" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-519"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">MOD</script> là số nguyên tố.</li>
</ul>

<p>Phần chứng minh sai số bạn có thể đọc thêm trong <a href="http://rng-58.blogspot.sg/2017/02/hashing-and-probability-of-collision.html">blog rng_58</a>, tuy nhiên phần chứng minh rất phức tạp nên mình sẽ không trình bày ở đây.</p>

<h2><a class="anchor" id="chi-tiết-cài-đặt_2-chọn-hệ-cơ-số" href="#chi-tiết-cài-đặt_2-chọn-hệ-cơ-số"><i class="fa fa-link"></i></a>2. Chọn hệ cơ số</h2>

<p>Mình khuyến khích các bạn chọn hệ cơ số &gt; 256 (Mình thường chọn là
 số nguyên tố 311). Nếu bạn chọn hệ cơ số là 31, bạn chỉ làm việc với 
xâu gồm toàn các kí tự in thường, và phải "mã hóa" các kí tự từ <code>a</code> đến <code>z</code>
 thành các số từ 1 đến 26. Điều này khiến code của bạn bị dài. Nếu bài 
toán cho xâu có các kí tự 'A'...'Z', 'a'..'z' và '0'...'9', việc bạn mã 
hóa chúng thành các số từ 1 đến 64 là phức tạp và không cần thiết.</p>

<p>Chưa kể, nếu bạn quên mất không <code>+1</code> và mã hoá <code>a</code> thành <code>0</code> là hành động tự treo cổ vì rất dễ bị hack.</p>

<p>Nếu bạn chọn hệ cơ số &gt; 256, bạn chỉ cần dùng mã ASCII của các kí tự là xong, và lại tránh bị hack.</p>

<h2><a class="anchor" id="chi-tiết-cài-đặt_3-chọn-modulo" href="#chi-tiết-cài-đặt_3-chọn-modulo"><i class="fa fa-link"></i></a>3. Chọn modulo</h2>

<p>Nếu bạn không hiểu rõ về cách đánh giá độ chính xác của thuật Hash (trình bày ở mục <a href="#%C4%90%C3%A1nh-gi%C3%A1-%C4%91%E1%BB%99-ch%C3%ADnh-x%C3%A1c">Đánh giá độ chính xác</a>), bạn chỉ cần chọn 3-4 số nguyên tố khác nhau làm <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">MOD</script>. Bạn có thể tham khảo <a href="http://codeforces.com/contest/727/submission/21451704">code của Phạm Văn Hạnh</a>. Tuy nhiên các bạn cũng nên lưu ý là dùng nhiều <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-528" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">MOD</script> quá cũng làm chương trình chạy chậm đi.</p>

<h2><a class="anchor" id="chi-tiết-cài-đặt_4-hash-tràn-số-và-hash-có-mod" href="#chi-tiết-cài-đặt_4-hash-tràn-số-và-hash-có-mod"><i class="fa fa-link"></i></a>4. Hash tràn số và Hash có MOD</h2>

<p>Trên thực tế, khi cài đặt Hash sử dụng nhiều phép <code>mod</code> sẽ làm chương trình chạy chậm. Vì vậy, để tăng tốc độ, người ta thường cài đặt với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;64&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-533" style="width: 6.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.203em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.188em, 1005.2em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-534"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-539" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.282em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.45em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-540" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 0.5em;"><span class="texatom" id="MathJax-Span-541"><span class="mrow" id="MathJax-Span-542"><span class="mn" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Main;">64</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi><mo>=</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>64</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-79">MOD = 2^{64}</script>. Do đó, nếu sử dụng kiểu dữ liệu số 64-bit, ta không cần dùng phép <code>mod</code> mà cứ để các phép tính tràn số. Kĩ thuật này được gọi là Hash tràn số. Tuy nhiên khi cài đặt như vậy có một vài chú ý:</p>

<ul>
<li>Việc sử dụng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">MOD</script>
 không phải là số nguyên tố (và hơn nữa lại là 1 số cố định) khiến cho 
hàm Hash không đủ tốt. Nếu test được sinh ngẫu nhiên, thì nó không có 
vấn đề gì cả. Nhưng ở trên Codeforces, vì những người thi cùng có thể 
"hack" code của bạn bằng test tự sinh, nên bạn hầu như không thể AC các 
bài Hash với Hash tràn số. Bạn có thể đọc thêm về cách sinh test giết 
Hash tràn số <a href="http://codeforces.com/blog/entry/4898">ở đây</a>. Cách giải quyết là dùng hash tràn số kết hợp với một <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-549" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">MOD</script> khác.</li>
<li>Nếu dùng Pascal, cần tắt báo tràn số (<code>$Q-</code>), nếu không chương trình sẽ chạy bị lỗi.</li>
</ul>

<h2><a class="anchor" id="chi-tiết-cài-đặt_5-một-số-lời-khuyên-nho-nhỏ" href="#chi-tiết-cài-đặt_5-một-số-lời-khuyên-nho-nhỏ"><i class="fa fa-link"></i></a>5. Một số lời khuyên nho nhỏ</h2>

<p>Chỉ so sánh mã hash của hai xâu có cùng độ dài. Hiển nhiên, hai xâu 
kí tự không cùng độ dài thì không bằng nhau. Điều này có thể giảm xác 
suất rủi ro khi hash một modulo đáng kể.</p>

<h1><a class="anchor" id="Ứng-dụng" href="#Ứng-dụng"><i class="fa fa-link"></i></a>Ứng dụng</h1>

<p>Như đã đề cập ở trên, thuật toán này sẽ có trường hợp chạy sai. Tất 
nhiên, bên cạnh việc sử dụng Hash, còn có nhiều thuật toán xử lý xâu 
chuỗi khác, mang lại sự chính xác tuyệt đối. Tôi tạm gọi những thuật 
toán đó là <em>‘thuật toán chuẩn’</em>. Việc cài đặt <em>‘thuật toán chuẩn’</em>
 có thể mang lại một tốc độ chạy chương trình cao hơn, độ chính xác của 
chương trình lớn hơn. Tuy nhiên, người làm bài sẽ phải trả giá là sự 
phức tạp khi cài đặt các <em>‘thuật toán chuẩn’</em> đó.</p>

<p>Sử dụng Hash không chỉ giúp người làm bài dễ dàng cài đặt hơn mà quan trọng ở chỗ: Hash có thể làm được những việc mà <em>‘thuật toán chuẩn’</em> không làm được. Sau đây, tôi sẽ xét một vài ví dụ để chứng minh điều này.</p>

<h2><a class="anchor" id="Ứng-dụng_longest-palindrome-substring" href="#Ứng-dụng_longest-palindrome-substring"><i class="fa fa-link"></i></a><a href="http://vnoi.info/problems/show/PALINY">Longest palindrome substring</a></h2>

<p>Bài toán đặt ra như sau: Bạn được cho một xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-554" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">s</script> độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;000&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-557" style="width: 7.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.125em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.03em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mn" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.278em;">50</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.167em;">000</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>≤</mo><mn>50</mn><mo>,</mo><mn>000</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">n (n \le 50,000)</script>. Bạn cần tìm độ dài của xâu đối xứng dài nhất gồm các kí tự liên tiếp trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-567" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">s</script>. (Xâu đối xứng là xâu đọc từ 2 chiều giống nhau).</p>

<ul>
<li>Một <em>‘thuật toán chuẩn’</em> không thể áp dụng vào bài toán này đó là thuật toán KMP. Ngoài KMP ra, có 2 <em>‘thuật toán chuẩn’</em>
 có thể áp dụng được. Thuật toán thứ nhất đó là sử dụng thuật toán 
Manacher để tính bán kính đối xứng tại tất cả vị trí trong xâu. Thuật 
toán thứ 2 đó là sử dụng Suffix Array và LCP (Longest Common Prefix) cho
 xâu được nối bởi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-570" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">s</script> và xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-573" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-574"><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">s</script>
 viết theo thứ tự ngược lại. 2 thuật toán này đều không dễ, và nằm ngoài
 phạm vi bài viết, nên tôi chỉ nêu sơ qua mà không đi vào chi tiết.</li>
<li>Bây giờ, chúng ta sẽ xét thuật toán <em>‘không chuẩn’</em> là thuật 
toán Hash. Để đơn giản, chúng ta xét trường hợp độ dài của xâu đối xứng 
là lẻ (trường hợp chẵn xử lý hoàn toàn tương tự).</li>
<li>Giả sử xâu đối xứng độ dài lẻ dài nhất có độ dài là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-576" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-577"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">l</script>. Dễ thấy, trong xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">s</script> tồn tại xâu đối xứng độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-582" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1001.95em, 2.467em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-583"><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-586" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.168em; border-left: 0px solid; width: 0px; height: 1.088em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-89">l−2</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-587" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1001.98em, 2.467em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-590" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-591" style="font-family: MathJax_Main; padding-left: 0.222em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.168em; border-left: 0px solid; width: 0px; height: 1.088em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>−</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-90">l−4</script>,... Tuy nhiên, xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-592" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-593"><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">s</script> không tồn tài xâu đối xứng độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-595" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1001.95em, 2.467em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-599" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.168em; border-left: 0px solid; width: 0px; height: 1.088em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-92">l+2</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-600" style="width: 2.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1001.98em, 2.467em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-601"><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-604" style="font-family: MathJax_Main; padding-left: 0.222em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.168em; border-left: 0px solid; width: 0px; height: 1.088em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>+</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-93">l+4</script>, ... Như vậy, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-605" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-606"><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">s</script> thỏa mãn tính chất chia nhị phân. Chúng ta sẽ chia nhị phân để tìm độ dài lớn nhất có thể. Với mỗi độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-608" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-95">l</script>, chúng ta cần kiểm tra xem trong xâu có tồn tại một xâu con là xâu đối xứng độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-611" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">l</script> hay không. Để làm việc này, ta duyệt qua tất cả tất cả các xâu con độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-614" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">l</script> trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">s</script>.</li>
<li>Bài toán còn lại là: kiểm tra xem <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-620" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.54em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">s[i..j]</script> với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-629" style="width: 20.165em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.369em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1016.27em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-630"><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-632" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">j</span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">;</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">i</span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-645" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main; padding-left: 0.278em; padding-right: 0.278em;">mod</span><span class="mn" id="MathJax-Span-648" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-650" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="mo" id="MathJax-Span-651" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>m</mi><mo>;</mo><mo stretchy="false">(</mo><mi>j</mi><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>2</mn><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">(1 \le i \le j \le m; (j−i+1) \bmod 2 = 1)</script> có phải là xâu đối xứng hay không.</li>
<li>Cách làm như sau. Gọi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-652" style="width: 0.491em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.379em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.271em, 1000.35em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-653"><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.917em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">t</script> là xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-655" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-656"><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">s</script> viết theo thứ tự ngược lại. Bằng thuật toán Hash, chúng ta có thể kiểm tra được một xâu con nào đó của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-658" style="width: 0.491em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.379em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.271em, 1000.35em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.917em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">t</script> có bằng một xâu con nào đó của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-661" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">s</script> hay không. Như vậy, chúng ta cần kiểm tra <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-664" style="width: 3.417em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.764em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1002.65em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-665"><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">k</span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>.</mo><mo>.</mo><mi>k</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-105">s[i..k]</script> có bằng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1..&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-673" style="width: 11.602em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.431em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1009.31em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">j</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-681" style="font-family: MathJax_Main; padding-left: 0.222em;">1..</span><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">k</span><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo stretchy="false">[</mo><mi>n</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1..</mn><mi>n</mi><mo>−</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">t[n−j+1..n−k+1]</script> hay không với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-688" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-689"><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-107">k</script> là tâm đối xứng, nói cách khác <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-691" style="width: 6.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.528em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1005.48em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-692"><span class="mi" id="MathJax-Span-693" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">j</span><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-700"><span class="mrow" id="MathJax-Span-701"><span class="mo" id="MathJax-Span-702" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-703" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mi>j</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-108">k = (i+j)/2</script>. Như vậy bài toán đã được giải. Độ phức tạp cho cách làm này là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-704" style="width: 5.911em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.77em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.68em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-711" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-713" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-715" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-109">O(n log(n))</script>.</li>
</ul>

<h2><a class="anchor" id="Ứng-dụng_k-th-alphabetical-cyclic" href="#Ứng-dụng_k-th-alphabetical-cyclic"><i class="fa fa-link"></i></a>k-th alphabetical cyclic</h2>

<p>Bài toán đặt ra như sau: Bạn được cho một dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;000&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-716" style="width: 13.661em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.111em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1011.02em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-717"><span class="msubsup" id="MathJax-Span-718"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-720" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-721" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-722" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-724" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-726" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-730" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mn" id="MathJax-Span-736" style="font-family: MathJax_Main; padding-left: 0.278em;">50</span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-738" style="font-family: MathJax_Main; padding-left: 0.167em;">000</span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi>n</mi><mo>≤</mo><mn>50</mn><mo>,</mo><mn>000</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">a_1, a_2,... , a_n (n \le 50,000)</script>. Sắp xếp <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-740" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-111">n</script> hoán vị vòng tròn của dãy này theo thứ tự từ điển. Cụ thể, các hoán vị vòng quanh của dãy này là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-743" style="width: 7.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.341em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.25em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-744"><span class="mo" id="MathJax-Span-745" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-746"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-748" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-750" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-752" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-753" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-757" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-758" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-112">(a_1, a_2,... , a_n)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-762" style="width: 9.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.751em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1007.66em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-763"><span class="mo" id="MathJax-Span-764" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-768" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-769" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-774" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-777" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-779" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-780" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-781" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-783" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><msub><mi>a</mi><mn>3</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">(a_2, a_3, ..., a_n, a_1)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-785" style="width: 11.222em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.106em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1009.01em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-786"><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-790" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-792" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-794" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-798" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-800" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-802" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-804" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-808" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mn>3</mn></msub><mo>,</mo><msub><mi>a</mi><mn>4</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-114">(a_3, a_4, ..., a_n, a_1, a_2)</script>,...
 Dãy này có thứ tự từ điển nhỏ hơn dãy kia nếu số đầu tiên khác nhau của
 dãy này nhỏ hơn dãy kia. Yêu cầu bài toán là: In ra dãy có thứ tự từ 
điển lớn thứ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-812" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-813"><span class="mi" id="MathJax-Span-814" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">k</script>.</p>

<ul>
<li>Bài toán này có thể được giải bằng Suffix Array, tuy nhiên cách cài 
đặt phức tạp và không phải trọng tâm của bài viết nên tôi sẽ không nêu 
ra ở đây.</li>
<li>Nếu tiếp cận một cách trực tiếp, chúng ta sẽ sinh ra tất cả các dãy 
hoán vị vòng quanh, rồi sau đó dùng một thuật toán sắp xếp để sắp xếp 
lại chúng theo thứ tự từ điển, cuối cùng chỉ việc in ra dãy thứ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-815" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-816"><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">k</script>
 sau khi sắp xếp. Tuy nhiên độ phức tạp của thuật toán này là rất lớn và
 không thể đáp ứng được yêu cầu về thời gian. Cụ thể, cách này có độ 
phức tạp là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-818" style="width: 7.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.125em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.226em, 1006.03em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-819"><span class="mi" id="MathJax-Span-820" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-822"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.58em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.6em;"><span class="mn" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-825" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-826" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-828" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-832" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.466em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">O(n^2 * log(n))</script>, đây là tích của độ phức tạp của sắp xếp và độ phức tạp của mỗi phép so sánh dãy.</li>
<li>Vẫn giữ tư tưởng là sắp xếp lại tất cả các dãy hoán vị vòng quanh rồi in ra dãy đứng ở vị trí thứ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-833" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-834"><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">k</script>, chúng ta cố gắng cải tiến độ phức tạp của việc so sánh thứ tự từ điển của 2 dãy.</li>
<li>Nhắc lại định nghĩa về thứ tự từ điển của 2 dãy: Xét 2 dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-836" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">a</script> và <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-839" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-840"><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">b</script> có cùng số phần tử. Gọi ví trí thứ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-842" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.236em, 1000.28em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.96em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">i</script> là vị trí đầu tiên từ trái sang mà <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-845" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.927em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.344em, 1002.93em, 2.6em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-846"><span class="msubsup" id="MathJax-Span-847"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main; padding-left: 0.278em;">≠</span><span class="msubsup" id="MathJax-Span-851" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.429em;"><span class="mi" id="MathJax-Span-853" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.331em; border-left: 0px solid; width: 0px; height: 1.278em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>≠</mo><msub><mi>b</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-122">a_i \ne b_i</script>. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D4;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-854" style="width: 8.295em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.721em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1006.72em, 2.543em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-855"><span class="mi" id="MathJax-Span-856" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main; padding-left: 0.278em;">⇔</span><span class="msubsup" id="MathJax-Span-860" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.848em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-863" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="msubsup" id="MathJax-Span-864" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.748em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.184em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.429em;"><span class="mi" id="MathJax-Span-866" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.261em; border-left: 0px solid; width: 0px; height: 1.181em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>&lt;</mo><mi>b</mi><mo stretchy="false">⇔</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>b</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">a < b \Leftrightarrow a_i < b_i</script>. Như vậy, ta phải tìm đoạn tiền tố giống nhau dài nhất của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-867" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-868"><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">a</script> và <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-870" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.43em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">b</script>, rồi so sánh kí tự tiếp theo. Để tìm được đoạn tiền tố giống nhau dài nhất, ta có thể sử dụng Hash kết hợp với chia nhị phân.</li>
<li>Để giải được bài này, cần sử dụng thêm một kỹ thuật nhỏ nữa: Thay vì
 sinh ra tất cả các hoán vị vòng quanh, chúng ta chỉ cần nhân đôi dãy <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-873" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.456em, 1000.52em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-874"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.688em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">a</script> lên, dãy mới sẽ có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-876" style="width: 1.358em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.084em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.394em, 1001.06em, 2.396em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-877"><span class="mn" id="MathJax-Span-878" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.966em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">2n</script> phần tử: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-880" style="width: 15.233em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.358em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1012.26em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-881"><span class="mo" id="MathJax-Span-882" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-883"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-887" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-890" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-894" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-895" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-898" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-899" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-902" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-903" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mn" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-907" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-909" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-910" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-911" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.028em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.51em, 4.183em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -3.861em; left: 0.529em;"><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-914" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-128">(a_1, a_2, ..., a_n, a_1, a_2, ..., a_n)</script>. Một hoán vị vòng quanh sẽ là một dãy con liên tiếp độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-915" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.58em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-916"><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">n</script> của dãy nhân đôi này.</li>
</ul>

<p>Từ đó ta thu được thuật toán với độ phức tạp <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-918" style="width: 7.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.179em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.226em, 1006.08em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-921" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-923" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">l</span><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="msubsup" id="MathJax-Span-926"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.48em, 4.378em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.531em;"><span class="mn" id="MathJax-Span-928" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-929" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.466em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>∗</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-130">O(n*log^2(n))</script></p>

<h2><a class="anchor" id="Ứng-dụng_longest-substring-and-appear-at-least-k-times" href="#Ứng-dụng_longest-substring-and-appear-at-least-k-times"><i class="fa fa-link"></i></a>Longest substring and appear at least k times</h2>

<p>Bài toán đặt ra như sau: Bạn được cho xâu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-933" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-934"><span class="mi" id="MathJax-Span-935" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">s</script> độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;000&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-936" style="width: 7.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.125em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1006.03em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-937"><span class="mi" id="MathJax-Span-938" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-939" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-940" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-941" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mn" id="MathJax-Span-942" style="font-family: MathJax_Main; padding-left: 0.278em;">50</span><span class="mo" id="MathJax-Span-943" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-944" style="font-family: MathJax_Main; padding-left: 0.167em;">000</span><span class="mo" id="MathJax-Span-945" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>≤</mo><mn>50</mn><mo>,</mo><mn>000</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-132">n (n \le 50,000)</script>, bạn cần tìm ra xâu con của <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-946" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-947"><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">s</script> có độ dài lớn nhất, và xâu con này xuất hiện ít nhất <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-949" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-950"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">k</script> lần.</p>

<ul>
<li>Bài toán này có thể được giải bằng Suffix Array, tuy nhiên cách cài 
đặt phức tạp và không phải trọng tâm của bài viết nên tôi sẽ không nêu 
ra ở đây.</li>
<li>Tiếp tục bàn đến thuật toán Hash để thay thế thuật toán chuẩn. Nhận xét rằng, giả sử độ dài lớn nhất tìm được là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-952" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-953"><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">l</script>, thì với mọi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-955" style="width: 2.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.222em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1002.19em, 2.523em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-956"><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="texatom" id="MathJax-Span-958"><span class="mrow" id="MathJax-Span-959"><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_SansSerif; font-style: italic;">'</span></span></span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main; padding-left: 0.278em;">≤</span><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">l</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.236em; border-left: 0px solid; width: 0px; height: 1.157em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo>′</mo></mrow><mo>≤</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">l′ \le l</script>, luôn tồn tại xâu có độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-963" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.65em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-964"><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="texatom" id="MathJax-Span-966"><span class="mrow" id="MathJax-Span-967"><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_SansSerif; font-style: italic;">'</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo>′</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-137">l′</script> xuất hiện ít nhất <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-969" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-970"><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">k</script> lần. Tuy nhiên, với mọi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-972" style="width: 2.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.222em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.366em, 1002.19em, 2.425em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-973"><span class="mi" id="MathJax-Span-974" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="texatom" id="MathJax-Span-975"><span class="mrow" id="MathJax-Span-976"><span class="mo" id="MathJax-Span-977" style="font-family: MathJax_SansSerif; font-style: italic;">'</span></span></span><span class="mo" id="MathJax-Span-978" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mi" id="MathJax-Span-979" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">l</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.116em; border-left: 0px solid; width: 0px; height: 1.036em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo>′</mo></mrow><mo>&gt;</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">l′ > l</script>, không tồn tại xâu có độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-980" style="width: 0.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.596em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.65em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-981"><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="texatom" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_SansSerif; font-style: italic;">'</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo>′</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-140">l′</script> xuất hiện ít nhất <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-986" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">k</script> lần (do <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-989" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-990"><span class="mi" id="MathJax-Span-991" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">l</script> đã là lớn nhất). Như vậy, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-992" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-993"><span class="mi" id="MathJax-Span-994" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">l</script>  thỏa mãn tính chất chia nhị phân. Chúng ta có thể áp dụng thuật toán tìm kiếm nhị phân để tìm ra <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-995" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-996"><span class="mi" id="MathJax-Span-997" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">l</script> lớn nhất.</li>
<li>Bây giờ, với mỗi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-998" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-999"><span class="mi" id="MathJax-Span-1000" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">l</script> khi đang chia nhị phân, chúng ta sẽ phải kiểm tra liệu có tồn tại xâu con nào xuất hiện ít nhất <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1001" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1002"><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">k</script> lần hay không. Điều này được làm rất đơn giản, bằng cách sinh mọi mã Hash của các xâu con độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1004" style="width: 0.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.52em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1005"><span class="mi" id="MathJax-Span-1006" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">k</script> trong <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1007" style="width: 0.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.455em, 1000.44em, 2.232em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.689em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">s</script>.
 Sau đó sắp xếp lại các mã Hash này theo chiều tăng dần, rồi kiếm tra 
xem có một đoạn liên tiếp các mã Hash nào giống nhau độ dài <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1010" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.325em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.203em, 1000.29em, 2.233em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012" style="font-family: MathJax_Math; font-style: italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">l</script> hay không.</li>
<li>Như vậy, độ phức tạp để  chia nhị phân là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1013" style="width: 5.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.173em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.08em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1014"><span class="mi" id="MathJax-Span-1015" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-1016" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1023" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-150">O(log(n))</script>, độ phức tạp của sắp xếp là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1024" style="width: 5.911em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.77em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.31em, 1004.68em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1025"><span class="mi" id="MathJax-Span-1026" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-1027" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1028" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1029" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1030" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-1031" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1032" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1033" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-1034" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.363em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-151">O(n log(n))</script>, vậy độ phức tạp của cả bài toán là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1036" style="width: 6.507em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.257em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.226em, 1005.16em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1037"><span class="mi" id="MathJax-Span-1038" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-1041" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="msubsup" id="MathJax-Span-1043"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.48em, 4.378em, -1000em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-1044" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.531em;"><span class="mn" id="MathJax-Span-1045" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1046" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1047" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1049" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.466em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>l</mi><mi>o</mi><msup><mi>g</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-152">O(n log^2(n) )</script>.</li>
</ul>

<h1><a class="anchor" id="Đánh-giá-độ-chính-xác" href="#Đánh-giá-độ-chính-xác"><i class="fa fa-link"></i></a>Đánh giá độ chính xác</h1>

<p>Thông thường, khi sử dụng Hash, ta thường gặp phải 2 trường hợp như sau:</p>

<ol>
<li>Trả lời <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1050" style="width: 1.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.813em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1000.76em, 2.416em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1051"><span class="mi" id="MathJax-Span-1052" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.238em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">Q</script> truy vấn, mỗi truy vấn có dạng kiểm tra 2 đoạn con của 2 xâu có bằng nhau hay không</li>
<li>Cho <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1053" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.92em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1054"><span class="mi" id="MathJax-Span-1055" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-154">N</script> xâu, kiểm tra tất cả các xâu có phân biệt hay không.</li>
</ol>

<p>Giả sử ta chọn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1056" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1057"><span class="mi" id="MathJax-Span-1058" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1060" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">MOD</script> là một số nguyên tố khoảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" style="width: 1.737em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.033em, 1001.41em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1062"><span class="msubsup" id="MathJax-Span-1063"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1064" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1065" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.223em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>9</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-156">10^9</script>, và giả sử dữ liệu được sinh ngẫu nhiên và hàm hash của chúng ta đủ tốt để Hash của các xâu được phân bố đều và ngẫu nhiên.</p>

<h2><a class="anchor" id="Đánh-giá-độ-chính-xác_trường-hợp-1" href="#Đánh-giá-độ-chính-xác_trường-hợp-1"><i class="fa fa-link"></i></a>Trường hợp 1</h2>

<p>Giả sử <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1066" style="width: 1.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.813em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1000.76em, 2.416em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1067"><span class="mi" id="MathJax-Span-1068" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.238em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-157">Q</script> khoảng <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1069" style="width: 1.737em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.033em, 1001.41em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1070"><span class="msubsup" id="MathJax-Span-1071"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1072" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1073" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.223em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-158">10^5</script>, và bộ test có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1074" style="width: 4.285em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.469em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.383em, 1003.43em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1075"><span class="mi" id="MathJax-Span-1076" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span class="mo" id="MathJax-Span-1077" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1078" style="font-family: MathJax_Main; padding-left: 0.278em;">100</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.993em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-159">T = 100</script> test.</p>

<ul>
<li>Với 2 xâu khác nhau, xác suất để nó có cùng Hash là xấp xỉ <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1079" style="width: 2.93em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.385em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1002.39em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1080"><span class="mn" id="MathJax-Span-1081" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-1082"><span class="mrow" id="MathJax-Span-1083"><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1086" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-160">1 / 10^9</script>. Như vậy, xác suất để trả lời đúng 1 truy vấn là: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1088" style="width: 5.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.119em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1004.12em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1089"><span class="mn" id="MathJax-Span-1090" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1091" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1092" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="texatom" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mo" id="MathJax-Span-1095" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1096"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1097" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1098" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-161">1 - 1 / 10^9</script>.</li>
<li>Ở trường hợp xấu nhất, ta có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1099" style="width: 1.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.813em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1000.76em, 2.416em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1100"><span class="mi" id="MathJax-Span-1101" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.238em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">Q</script> truy vấn mà mỗi truy vấn là một cặp xâu khác nhau. Xác suất để ta trả lời đúng tất cả các truy vấn là: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1102" style="width: 6.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.474em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1005.47em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1103"><span class="mo" id="MathJax-Span-1104" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1105" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1106" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1107" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="texatom" id="MathJax-Span-1108"><span class="mrow" id="MathJax-Span-1109"><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1111"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1112" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1113" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1114"><span style="display: inline-block; position: relative; width: 1.023em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.29em, 4.423em, -1000em); top: -4.011em; left: 0em;"><span class="mo" id="MathJax-Span-1115" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.389em;"><span class="mi" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><msup><mo stretchy="false">)</mo><mi>Q</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-163">(1 - 1 / 10^9)^Q</script>.</li>
<li>Xác suất để ta trả lời đúng tất cả các truy vấn của tất cả các test là: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1117" style="width: 7.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.341em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1006.34em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1118"><span class="mo" id="MathJax-Span-1119" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1120" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1121" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1122" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="texatom" id="MathJax-Span-1123"><span class="mrow" id="MathJax-Span-1124"><span class="mo" id="MathJax-Span-1125" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1126"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1127" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1129"><span style="display: inline-block; position: relative; width: 1.875em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.29em, 4.423em, -1000em); top: -4.011em; left: 0em;"><span class="mo" id="MathJax-Span-1130" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.374em; left: 0.389em;"><span class="texatom" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="mi" id="MathJax-Span-1133" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>Q</mi><mo>∗</mo><mi>T</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-164">(1 - 1 / 10^9)^{Q * T}</script>.</li>
</ul>

<p>Thay số vào, xác suất để trả lời đúng tất cả các truy vấn là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0.9900&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1136" style="width: 3.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.71em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.394em, 1002.67em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1137"><span class="mn" id="MathJax-Span-1138" style="font-family: MathJax_Main;">0.9900</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.98em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.9900</mn></math></span></span><script type="math/tex" id="MathJax-Element-165">0.9900</script>, đủ lớn để ta yên tâm qua tất cả các test, với điều kiện test không được sinh dựa trên <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1139" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1140"><span class="mi" id="MathJax-Span-1141" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-166">P</script>. (Chú ý nếu bạn đang thi những contest như Topcoder/Codeforces, người khác có thể đọc được <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1142" style="width: 0.978em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.214em, 1000.76em, 2.222em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1143"><span class="mi" id="MathJax-Span-1144" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.067em; border-left: 0px solid; width: 0px; height: 0.973em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-167">P</script> của bạn và sinh test để challenge code của bạn).</p>

<h2><a class="anchor" id="Đánh-giá-độ-chính-xác_trường-hợp-2" href="#Đánh-giá-độ-chính-xác_trường-hợp-2"><i class="fa fa-link"></i></a>Trường hợp 2</h2>

<p>Theo <a href="https://en.wikipedia.org/wiki/Birthday_problem">Birthday Paradox</a>, ta dễ dàng thấy rằng, nếu có <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msqrt&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/msqrt&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1145" style="width: 7.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.854em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.188em, 1005.85em, 2.534em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1146"><span class="msqrt" id="MathJax-Span-1147"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.75em, 4.173em, -1000em); top: -4.011em; left: 0.833em;"><span class="mrow" id="MathJax-Span-1148"><span class="mi" id="MathJax-Span-1149" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; clip: rect(3.575em, 1000.86em, 3.945em, -1000em); top: -4.589em; left: 0.833em;"><span style="display: inline-block; position: relative; width: 0.86em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.011em; left: -0.084em;">−<span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.011em; left: 0.166em;">−<span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; clip: rect(3.048em, 1000.85em, 4.373em, -1000em); top: -4.062em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1150" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1151" style="font-family: MathJax_Main; padding-left: 0.278em;">3</span><span class="mo" id="MathJax-Span-1152" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="msubsup" id="MathJax-Span-1153" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1154" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1155" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.25em; border-left: 0px solid; width: 0px; height: 1.389em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mi>P</mi></msqrt><mo>=</mo><mn>3</mn><mo>∗</mo><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-168">\sqrt{P} = 3*10^4</script> xâu, xác suất để 2 xâu bằng nhau là rất lớn. Thật vậy, xác suất để tất cả các xâu khác nhau là:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1156" style="width: 28.892em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.469em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.196em, 1023.37em, 2.635em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1157"><span class="mo" id="MathJax-Span-1158" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1159" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1161" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="mo" id="MathJax-Span-1164" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1165"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1166" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1167" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1168" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mo" id="MathJax-Span-1170" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1171" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1172" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1173" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="texatom" id="MathJax-Span-1174"><span class="mrow" id="MathJax-Span-1175"><span class="mo" id="MathJax-Span-1176" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1177"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1178" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1179" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mo" id="MathJax-Span-1182" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-1183" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1184" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mn" id="MathJax-Span-1185" style="font-family: MathJax_Main; padding-left: 0.222em;">3</span><span class="texatom" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1189"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1190" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1192" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1193" style="font-family: MathJax_Main;">∗</span><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-1195" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1196" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main; padding-left: 0.167em;">(</span><span class="mn" id="MathJax-Span-1198" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="mi" id="MathJax-Span-1200" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="texatom" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="mo" id="MathJax-Span-1203" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-1204"><span style="display: inline-block; position: relative; width: 1.429em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.96em, 4.195em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1205" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 1em;"><span class="mn" id="MathJax-Span-1206" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span><span class="mo" id="MathJax-Span-1207" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.374em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>3</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo><mo>∗</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msup><mn>10</mn><mn>9</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-169">(1 - 1 / 10^9) * (1 - 2 / 10^9) * (1 - 3 / 10^9) * ... (1 - N / 10^9)</script>.</p>

<p>Với <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;000&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1208" style="width: 6.29em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.095em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.377em, 1005.06em, 2.579em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1209"><span class="mi" id="MathJax-Span-1210" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1212" style="font-family: MathJax_Main; padding-left: 0.278em;">30</span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1214" style="font-family: MathJax_Main; padding-left: 0.167em;">000</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.212em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>=</mo><mn>30</mn><mo>,</mo><mn>000</mn></math></span></span><script type="math/tex" id="MathJax-Element-170">N = 30,000</script>, tích trên là <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0.6376&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1215" style="width: 3.363em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.71em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.384em, 1002.67em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1216"><span class="mn" id="MathJax-Span-1217" style="font-family: MathJax_Main;">0.6376</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.992em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.6376</mn></math></span></span><script type="math/tex" id="MathJax-Element-171">0.6376</script>, nghĩa là bạn có gần <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0.40&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1218" style="width: 2.171em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.383em, 1001.69em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1219"><span class="mn" id="MathJax-Span-1220" style="font-family: MathJax_Main;">0.40</span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 0.993em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.40</mn></math></span></span><script type="math/tex" id="MathJax-Element-172">0.40</script> xác suất trả lời sai. Do vậy, bạn bắt buộc phải dùng nhiều <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1221" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1222"><span class="mi" id="MathJax-Span-1223" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-173">MOD</script> khác nhau.</p>

<h1><a class="anchor" id="tổng-kết" href="#tổng-kết"><i class="fa fa-link"></i></a>Tổng kết</h1>

<h2><a class="anchor" id="tổng-kết_thuật-toán" href="#tổng-kết_thuật-toán"><i class="fa fa-link"></i></a>Thuật toán</h2>

<p>Ý tưởng thuật toán Hash dựa trên việc đổi từ hệ cơ số lớn sang hệ 
thập phân, so sánh hai số thập phân lớn bằng cách so sánh phần dư của 
chúng với một số đủ lớn.</p>

<h2><a class="anchor" id="tổng-kết_cài-đặt" href="#tổng-kết_cài-đặt"><i class="fa fa-link"></i></a>Cài đặt</h2>

<p>Khi cài đặt Hash, ta cần chọn:</p>

<ul>
<li>Hệ cơ số</li>
<li>MOD</li>
</ul>

<p>Với những trang web mà người khác có thể đọc code bạn rồi tìm test 
sai (như Codeforces, Topcoder), nếu Hash tràn số hoặc MOD là 1 số nguyên
 biết trước, có thể sinh test để làm code bạn sai. Với những kỳ thi như 
HSG QG, IOI, ACM, và các Online Judge, thông thường sẽ không có những 
test như vậy. Tóm lại, khi chọn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1226" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1227"><span class="mi" id="MathJax-Span-1228" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1229" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-174">MOD</script> và hệ cơ số ta làm như sau:</p>

<ul>
<li>Chọn hệ cơ số là số nguyên tố lớn hơn số lượng ký tự (ví dụ 31, 71).</li>
<li>Chọn <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1231" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1232"><span class="mi" id="MathJax-Span-1233" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-175">MOD</script> đủ lớn theo nguyên tắc đã phân tích ở phần <a href="#%C4%90%C3%A1nh-gi%C3%A1-%C4%91%E1%BB%99-ch%C3%ADnh-x%C3%A1c">Đánh giá độ chính xác</a>.</li>
<li>Nếu là Topcoder hoặc Codeforces, dùng kết hợp Hash tràn số và 1 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1236" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-176">MOD</script> đủ lớn.</li>
<li>Nếu không phải Topcoder hay Codeforces, có thể dùng Hash tràn số. Nếu <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;64&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1241" style="width: 6.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.203em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.188em, 1005.2em, 2.407em, -1000em); top: -2.222em; left: 0em;"><span class="mrow" id="MathJax-Span-1242"><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math; font-style: italic;">D</span><span class="mo" id="MathJax-Span-1246" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1247" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.282em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1000.45em, 4.173em, -1000em); top: -4.011em; left: 0em;"><span class="mn" id="MathJax-Span-1248" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span><span style="position: absolute; top: -4.404em; left: 0.5em;"><span class="texatom" id="MathJax-Span-1249"><span class="mrow" id="MathJax-Span-1250"><span class="mn" id="MathJax-Span-1251" style="font-size: 70.7%; font-family: MathJax_Main;">64</span></span></span><span style="display: inline-block; width: 0px; height: 4.011em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.233em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi><mo>=</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>64</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-177">MOD = 2^{64}</script> chưa đủ lớn thì dùng thêm 1 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1252" style="width: 3.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.656em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.193em, 1002.63em, 2.244em, -1000em); top: -2.06em; left: 0em;"><span class="mrow" id="MathJax-Span-1253"><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mi" id="MathJax-Span-1256" style="font-family: MathJax_Math; font-style: italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.06em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.026em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>O</mi><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">MOD</script> nữa.</li>
</ul>

<h2><a class="anchor" id="tổng-kết_Ưu-điểm" href="#tổng-kết_Ưu-điểm"><i class="fa fa-link"></i></a>Ưu điểm</h2>

<p>Ưu điểm của thuật toán Hash là cài đặt rất dễ dàng. Linh động trong 
ứng dụng và có thể thay thế các thuật toán chuẩn ‘hầm hố’ khác.</p>

<h2><a class="anchor" id="tổng-kết_nhược-điểm" href="#tổng-kết_nhược-điểm"><i class="fa fa-link"></i></a>Nhược điểm</h2>

<p>Nhược điểm của thuật toán Hash là tính chính xác. Mặc dù rất khó sinh
 test để có thể làm cho thuật toán chạy sai, nhưng không phải là không 
thể. Vì vậy, để nâng cao tính chính xác của thuật toán, người ta thường 
dùng nhiều modulo khác nhau để so sánh mã Hash (ví dụ như dùng 3 modulo 
một lúc).</p>

<h1><a class="anchor" id="bài-tập-áp-dụng" href="#bài-tập-áp-dụng"><i class="fa fa-link"></i></a>Bài tập áp dụng</h1>

<ul>
<li><a href="http://vnoi.info/problems/show/SUBSTR/">VOJ - SUBSTR</a></li>
<li><a href="http://vnoi.info/problems/show/PALINY/">VOJ - PALINY</a></li>
<li><a href="http://vnoi.info/problems/show/DTKSUB/">VOJ - DTKSUB</a></li>
<li><a href="http://vnoi.info/problems/show/DTCSTR/">VOJ - DTCSTR</a></li>
<li><a href="http://vnoi.info/problems/show/TWOOPERS/">VOJ - TWOOPERS</a></li>
<li><a href="http://vnoi.info/problems/show/VOSTR/">VOJ - VOSTR</a></li>
<li><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=426">SGU 426</a></li>
</ul>

<h1><a class="anchor" id="các-nguồn-tham-khảo" href="#các-nguồn-tham-khảo"><i class="fa fa-link"></i></a>Các nguồn tham khảo</h1>

<ul>
<li><a href="http://en.wikipedia.org/wiki/String_searching_algorithm">Wikipedia - String Searching Algorithm</a></li>
<li><a href="http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">Wikipedia - KMP</a></li>
<li><a href="http://en.wikipedia.org/wiki/Rabin-Karp_string_search_algorithm">Wikipedia - Rabin Karp</a></li>
<li><a href="http://en.wikipedia.org/wiki/Alphabetical_order">Wikipedia - Alphabetical Order</a></li>
</ul>

    </div>
  </div>


  </div>

</div>
<div id="footer">
  <p id="last-edit">Last edited by <b>Thanh Trung Nguyen</b>, 2018-05-15 00:49:29</p>

  <script async="" src="Hash:%20A%20String%20Matching%20Algorithm_files/adsbygoogle.js"></script>
  <ins class="adsbygoogle" style="display: block; height: 460px;" data-ad-format="autorelaxed" data-ad-client="ca-pub-7999681867463377" data-ad-slot="5777921660" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:460px;margin:0;padding:0;position:relative;visibility:visible;width:920px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:460px;margin:0;padding:0;position:relative;visibility:visible;width:920px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:920px;height:460px;" width="920" height="460" frameborder="0"></iframe></ins></ins></ins>
  <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <hr><br>
  <div class="fb-like fb_iframe_widget" data-href="/wiki/algo/string/hash" data-width="1080" data-layout="button_count" data-action="like" data-size="large" data-show-faces="true" data-share="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=449532395210446&amp;container_width=920&amp;href=http%3A%2F%2Fvnoi.info%2Fwiki%2Falgo%2Fstring%2Fhash&amp;layout=button_count&amp;locale=en_GB&amp;sdk=joey&amp;share=true&amp;show_faces=true&amp;size=large&amp;width=1080"><span style="vertical-align: bottom; width: 145px; height: 28px;"><iframe name="f1c69c90764e01e" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 145px; height: 28px;" src="Hash:%20A%20String%20Matching%20Algorithm_files/like.html" class="" width="1080px" height="1000px" frameborder="0"></iframe></span></div>
  <div class="fb-save fb_iframe_widget" data-uri="/wiki/algo/string/hash" data-size="large" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=449532395210446&amp;container_width=920&amp;locale=en_GB&amp;sdk=joey&amp;size=large&amp;uri=http%3A%2F%2Fvnoi.info%2Fwiki%2Falgo%2Fstring%2Fhash"><span style="vertical-align: bottom; width: 146px; height: 28px;"><iframe name="f24dd5079d3673a" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:save Facebook Social Plugin" style="border: medium none; visibility: visible; width: 146px; height: 28px;" src="Hash:%20A%20String%20Matching%20Algorithm_files/save.html" class="" width="1000px" height="1000px" frameborder="0"></iframe></span></div>
  <br>
  <div class="fb-comments fb_iframe_widget fb_iframe_widget_fluid" data-href="vnoi.info//wiki/algo/string/hash" data-width="100%" data-numposts="5" fb-xfbml-state="rendered"><span style="height: 818px;"><iframe id="f1cea4682c3bbce" name="f78f6cc5ac05ac" scrolling="no" style="border: medium none; overflow: hidden; height: 818px; width: 100%;" title="Facebook Social Plugin" class="fb_ltr" src="https://www.facebook.com/plugins/comments.php?api_key=449532395210446&amp;channel_url=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FLnGK1eIuZ8c.js%3Fversion%3D42%23cb%3Df1ccc5e298360c%26domain%3Dvnoi.info%26origin%3Dhttp%253A%252F%252Fvnoi.info%252Ff3c27db3424db44%26relation%3Dparent.parent&amp;href=vnoi.info%2F%2Fwiki%2Falgo%2Fstring%2Fhash&amp;locale=en_GB&amp;numposts=5&amp;sdk=joey&amp;version=v2.7&amp;width=100%25"></iframe></span></div>

</div>
</div>

<form name="rename" method="POST" action="/wiki/rename/algo/string/hash">
  <input name="rename" type="hidden">
  <input name="message" type="hidden">
</form>




<ins class="adsbygoogle adsbygoogle-noablate" style="display: none;" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:NaNpx;margin:0;padding:0;position:relative;visibility:visible;width:NaNpx;background-color:transparent;"><ins id="aswift_0_anchor" style="display:block;border:none;height:NaNpx;margin:0;padding:0;position:relative;visibility:visible;width:NaNpx;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:NaNpx;height:NaNpx;" frameborder="0"></iframe></ins></ins></ins><iframe id="google_osd_static_frame_280299166810" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: italic; font-size-adjust: none; font-family: MathJax_SansSerif, sans-serif;"></div></div></body></html>